(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[710],{710:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AcceptMessage:()=>P,AcceptObserver:()=>E,ConnectMessage:()=>O,ConnectMessageObserver:()=>S,HandshakeMessage:()=>A,HandshakeObserver:()=>C,IncomingMessageType:()=>p,MP_SDK:()=>f,OutgoingMessageType:()=>w,RejectMessage:()=>D,RejectObserver:()=>I,connect:()=>R,version:()=>M});class n{constructor(e){this.messageReceiver=e}notify(e,t){this.messageReceiver.onMessageReceived(e,t)}}class r{constructor(){this.values={}}add(e,t){this.getValuesAtKey(e).push(t)}remove(e,t){const s=this.values[e];if(s){const e=s.indexOf(t);e>-1&&s.splice(e,1)}}removeKey(e){delete this.values[e]}getValuesAtKey(e){const t=this.values[e]||[];return this.values[e]=t,t}valuesPerKey(e){return this.getValuesAtKey(e).length}find(e,t){return this.values[e]&&this.values[e].find(t)}get keys(){return Object.keys(this.values)}hasKey(e){return e in this.values}has(e,t){return this.hasKey(e)&&this.values[e].includes(t)}*[Symbol.iterator](){for(const e in this.values)for(const t of this.values[e])yield[e,t]}}class i{listen(){}stopListening(){}send(){throw Error("The sdk has been disconnected and can't make any new calls")}}class o{constructor(e,t,s){this.sourceId=e,this.targetId=t,this.messageBridge=s,this.observers=new r}static toFilteredMessenger(e,t,s){const n=new c(e.sourceId,e.targetId,e,t);for(const t of s)for(const s of e.observers.getValuesAtKey(t))n.addObserver(s);return n}init(){const e=new class{constructor(e){this.messenger=e}onMessageReceived(e,t){this.messenger.onMessageReceived(e,t)}}(this),t=new n(e);this.messageBridge.listen(t)}dispose(){this.messageBridge.stopListening(),this.messageBridge=new i}addObserver(e){this.observers.add(e.messageType,e)}removeObserver(e){this.observers.remove(e.messageType,e)}send(e){const t=this.sourceId,s=this.targetId;this.messageBridge.send(Object.assign(Object.assign({},e),{fromId:t,toId:s,timestamp:Date.now()}))}onMessageReceived(e,t){if(!this.filterMessageId(e))return;const s=e.type,n=this.observers.getValuesAtKey(s);if(n)for(const s of n){const n=e.payload||e;s.notify(n,t,e.timestamp)}}filterMessageId(e){const t=e.toId,s=e.fromId;return t instanceof Array?t.indexOf(this.sourceId)>-1:(void 0===t||t===this.sourceId)&&s===this.targetId}}class c extends o{constructor(e,t,s,n){super(e,t,new i),this.messenger=s,this.sendFilter=n,this.errorBridge=new i}send(e){this.sendFilter.includes(e.type)?this.messenger.send(e):this.errorBridge.send()}}class a{constructor(e,t){this.sourceId=e,this.listenerBridge=t,this.observers=new r}init(){const e=new class{constructor(e){this.messenger=e}onMessageReceived(e,t){this.messenger.onMessageReceived(e,t)}}(this),t=new n(e);this.listenerBridge.listen(t)}dispose(){this.listenerBridge.stopListening()}addObserver(e){this.observers.add(e.messageType,e)}removeObserver(e){this.observers.remove(e.messageType,e)}send(e,t,s,n){s.send(Object.assign(Object.assign({},e),{fromId:this.sourceId,toId:t,timestamp:Date.now()}),n)}onMessageReceived(e,t){const s=e.type,n=this.observers.getValuesAtKey(s);if(n)for(const s of n){const n=e.payload||e;s.notify(n,t,e.timestamp)}}}class h{constructor(e){this.targetWindow=e,this.messageObserver=null,this.onMessage=e=>{if(this.messageObserver){const t=e.data;this.messageObserver.notify(Object.assign({},t),{id:t.fromId,origin:e.origin,source:e.source},e.data.timestamp)}}}listen(e){this.messageObserver||(this.messageObserver=e,this.targetWindow.addEventListener("message",this.onMessage))}stopListening(){this.targetWindow.removeEventListener("message",this.onMessage),this.messageObserver=null}}class d{constructor(e,t="*"){this.targetWindow=e,this.targetOrigin=t}send(e,t){this.targetWindow.postMessage(e,this.targetOrigin)}}class l{constructor(e,t,s="*"){this.sourceWindow=e,this.listener=new h(e),this.sender=new d(t,s)}listen(e){this.listener.listen(e)}stopListening(){this.listener.stopListening()}send(e){this.sender.send(e,this.sourceWindow)}}class u{constructor(e,t,s,n,r="*"){this.sourceId=e,this.sourceWindow=t,this.targetId=s,this.targetWindow=n,this.targetOrigin=r}createMessenger(){const e=new l(this.sourceWindow,this.targetWindow,this.targetOrigin);return new o(this.sourceId,this.targetId,e)}}var g=function(e,t,s,n){return new(s||(s=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,c)}a((n=n.apply(e,t||[])).next())}))};class v{constructor(){this.libraryCache=new Map}load(e,t){const s=this.libraryCache.get(e)||new m(e,t);return this.libraryCache.set(e,s),s.library}}class m{constructor(e,t){this._libraryPromise=new Promise(((e,t)=>{this.libraryResolver=e,this.libraryRejecter=t})),this.fetch(e,t)}fetch(e,t){return g(this,void 0,void 0,(function*(){let s;try{const t=new Request(e),n=new URL(t.url);if(!n.hostname.endsWith(window.location.hostname)&&!n.host.endsWith("matterport.com")&&!n.host.endsWith("matterportvr.cn"))return void this.libraryRejecter(`Request made for ${n.href} does not have the same origin as the request origin ${window.location.origin}`);s=yield fetch(new Request(e,{}))}catch(e){return void this.libraryRejecter(e)}if(!s.ok)return void this.libraryRejecter("Script not found.");const n={},r=yield s.text();if(new Function(r).call(n),t&&t in window){const e=window[t]||{};Object.assign(n,e),delete window[t]}this.libraryResolver(n)}))}get library(){return this._libraryPromise}}var f,w,p,y,b=function(e,t,s,n){return new(s||(s=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,c)}a((n=n.apply(e,t||[])).next())}))};!function(e){const t=new v;e.connect=function(e,s,n){return b(this,void 0,void 0,(function*(){let r;try{r=yield e.connect()}finally{e.cancelConnecting()}const i=yield function(e){return b(this,void 0,void 0,(function*(){if(!e)throw new Error("Unabled to load the sdk");try{const s=yield t.load(e,"sdk-client");if(s&&s.SdkBuilder&&"function"==typeof s.SdkBuilder)return s.SdkBuilder}catch(e){}throw Error(`Could not load the sdk from ${e}`)}))}(r.scriptUrl),o=s.getFactory(r);return function(e,t,s,n){return new t(s,e).build(n)}(n,i,o,r.serializedInterface)}))}}(f||(f={})),function(e){e.CONNECT="postmessage.connect"}(w||(w={})),function(e){e.HANDSHAKE="postmessage.handshake",e.ACCEPT="postmessage.accept",e.REJECT="postmessage.reject"}(p||(p={}));class O{constructor(e,t={}){this.type=w.CONNECT,this.payload={bootstrapVersion:e,options:{auth:t.auth,provider:t.provider}}}}class C{constructor(e){this.receiver=e,this.messageType=p.HANDSHAKE}notify(e,t,s){this.receiver.handshake()}}class E{constructor(e){this.receiver=e,this.messageType=p.ACCEPT}notify(e,t,s){const{sourceId:n,scriptUrl:r,targetId:i,targetOrigin:o}=e,c=e.interface;this.receiver.accept(n,r,c,i,o)}}class I{constructor(e){this.receiver=e,this.messageType=p.REJECT}notify(e,t,s){this.receiver.reject(e.reason)}}!function(e){e[e.IDLE=0]="IDLE",e[e.CONNECTING=1]="CONNECTING",e[e.HANDSHAKE=2]="HANDSHAKE",e[e.CONNECTED=3]="CONNECTED",e[e.REJECTED=4]="REJECTED"}(y||(y={}));class N{constructor(e,t,s){this.messenger=e,this.target=t,this.source=s,this.connectionState=y.IDLE,this.connectionPoll=void 0;const n=new class{constructor(e){this.connector=e}handshake(){this.connector.handshake()}accept(e,t,s,n,r){this.connector.accept(e,t,s,n,r)}reject(e){this.connector.reject(e)}}(this);this.handshakeObserver=new C(n),this.acceptObserver=new E(n),this.rejectObserver=new I(n),this.connectionPromise=new Promise(((e,t)=>{this.resolveConnection=e,this.rejectConnection=t}))}connect(e,t={}){return this.connectionState===y.IDLE&&(this.connectionState=y.CONNECTING,this.messenger.addObserver(this.handshakeObserver),this.messenger.addObserver(this.acceptObserver),this.messenger.addObserver(this.rejectObserver),this.connectionPoll=window.setInterval((()=>{this.messenger.send(new O(e,t),-1,this.target,this.source)}),500)),this.connectionPromise}cancelConnecting(){this.connectionState<y.CONNECTED&&(this.stopConnectPolling(),this.rejectConnection("User manually cancelled connection"))}handshake(){this.connectionState<y.HANDSHAKE&&(this.connectionState=y.HANDSHAKE,this.stopConnectPolling(),this.messenger.removeObserver(this.handshakeObserver))}accept(e,t,s,n,r){this.connectionState<y.CONNECTED&&(this.connectionState=y.CONNECTED,this.messenger.removeObserver(this.handshakeObserver),this.messenger.removeObserver(this.acceptObserver),this.messenger.removeObserver(this.rejectObserver),this.stopConnectPolling(),this.resolveConnection({sourceId:e,targetId:n,targetOrigin:r,scriptUrl:t,serializedInterface:s}))}reject(e){this.connectionState<y.CONNECTED&&(this.connectionState=y.REJECTED,this.messenger.removeObserver(this.handshakeObserver),this.messenger.removeObserver(this.acceptObserver),this.messenger.removeObserver(this.rejectObserver),this.stopConnectPolling(),this.rejectConnection(e))}stopConnectPolling(){clearInterval(this.connectionPoll),this.connectionPoll=void 0}}var T=function(e,t,s,n){return new(s||(s=Promise))((function(r,i){function o(e){try{a(n.next(e))}catch(e){i(e)}}function c(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,c)}a((n=n.apply(e,t||[])).next())}))};const M="3.0";function R(e,t={}){return T(this,void 0,void 0,(function*(){const s=(n=e).contentWindow?n.contentWindow:null;var n;if(!s)return Promise.reject("invalid window");const r=Math.floor(1e6*Math.random()),i=new h(window),o=new d(s),c=new a(r,i);c.init();const l=new N(c,o,window);return f.connect(new k(l,c,t),new j(s),window)}))}class k{constructor(e,t,s){this.connector=e,this.postMessage=t,this.options=s}connect(){return this.connector.connect(M,this.options)}cancelConnecting(){this.postMessage.dispose()}}class j{constructor(e){this.target=e}getFactory(e){return new u(e.sourceId,window,e.targetId,this.target,e.targetOrigin)}}class A{constructor(){this.type=p.HANDSHAKE,this.payload={}}}class P{constructor(e,t,s,n,r){this.type=p.ACCEPT,this.payload={scriptUrl:e,interface:t,sourceId:s,targetId:n,targetOrigin:r},this.interface=t}}class D{constructor(e){this.type=p.REJECT,this.payload={reason:e},this.reason=e}}class S{constructor(e){this.receiver=e,this.messageType=w.CONNECT}notify(e,t){this.receiver.onConnectionReceived(e,t)}}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvbWVzc2VuZ2Vycy9NZXNzZW5nZXIvQnJpZGdlT2JzZXJ2ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvdXRpbC9EaWN0QXJyYXkvRGljdEFycmF5LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9tZXNzZW5nZXJzL2Vycm9ybWVzc2FnZS9FcnJvck1lc3NhZ2VCcmlkZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL21lc3NlbmdlcnMvTWVzc2VuZ2VyL01lc3Nlbmdlci50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvbWVzc2VuZ2Vycy9NZXNzZW5nZXIvVW5kaXJlY3RlZE1lc3Nlbmdlci50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvbWVzc2VuZ2Vycy9wb3N0bWVzc2FnZS9VbmRpcmVjdGVkUG9zdE1lc3NhZ2VCcmlkZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL21lc3NlbmdlcnMvcG9zdG1lc3NhZ2UvUG9zdE1lc3NhZ2VCcmlkZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL21lc3NlbmdlcnMvcG9zdG1lc3NhZ2UvUG9zdE1lc3NhZ2VGYWN0b3J5LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL2R5bmFtaWMtbGliLWxvYWRlci9EeW5hbWljTGliTG9hZGVyLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01QX1NESy50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvYm9vdHN0cmFwL3NyYy9NZXNzYWdlVHlwZXMudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL2Jvb3RzdHJhcC9zcmMvQ29ubmVjdG9yL2luZGV4LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VzL0Nvbm5lY3RNZXNzYWdlLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VPYnNlcnZlcnMvSGFuZHNoYWtlT2JzZXJ2ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL2Jvb3RzdHJhcC9zcmMvTWVzc2FnZU9ic2VydmVycy9BY2NlcHRPYnNlcnZlci50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvYm9vdHN0cmFwL3NyYy9NZXNzYWdlT2JzZXJ2ZXJzL1JlamVjdE9ic2VydmVyLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9tZXNzZW5nZXJzL01lc3Nlbmdlci9JTWVzc2VuZ2VyLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL2luZGV4LnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VzL0hhbmRzaGFrZU1lc3NhZ2UudHMiLCJ3ZWJwYWNrOi8vLy4vcGFja2FnZXMvc2RrL2Jvb3RzdHJhcC9zcmMvTWVzc2FnZXMvQWNjZXB0TWVzc2FnZS50cyIsIndlYnBhY2s6Ly8vLi9wYWNrYWdlcy9zZGsvYm9vdHN0cmFwL3NyYy9NZXNzYWdlcy9SZWplY3RNZXNzYWdlLnRzIiwid2VicGFjazovLy8uL3BhY2thZ2VzL3Nkay9ib290c3RyYXAvc3JjL01lc3NhZ2VPYnNlcnZlcnMvQ29ubmVjdE9ic2VydmVyLnRzIl0sIm5hbWVzIjpbIkJyaWRnZU9ic2VydmVyIiwibWVzc2FnZVJlY2VpdmVyIiwibWVzc2FnZSIsImNsaWVudEluZm8iLCJ0aGlzIiwib25NZXNzYWdlUmVjZWl2ZWQiLCJEaWN0QXJyYXkiLCJ2YWx1ZXMiLCJrZXkiLCJ2YWx1ZSIsImdldFZhbHVlc0F0S2V5IiwicHVzaCIsInZhbHVlc0F0S2V5IiwiaWR4IiwiaW5kZXhPZiIsInNwbGljZSIsImxlbmd0aCIsInZhbEZpbmRlciIsImZpbmQiLCJPYmplY3QiLCJrZXlzIiwidmFsIiwiaGFzS2V5IiwiaW5jbHVkZXMiLCJTeW1ib2wiLCJpdGVyYXRvciIsIkVycm9yTWVzc2FnZUJyaWRnZSIsIkVycm9yIiwic291cmNlSWQiLCJ0YXJnZXRJZCIsIm1lc3NhZ2VCcmlkZ2UiLCJvYnNlcnZlcnMiLCJtZXNzZW5nZXIiLCJzZW5kRmlsdGVyIiwicmVjdkZpbHRlciIsImZpbHRlcmVkTWVzc2VuZ2VyIiwiRmlsdGVyZWRNZXNzZW5nZXIiLCJtc2dUeXBlIiwib2JzZXJ2ZXIiLCJhZGRPYnNlcnZlciIsIm1lc3NlbmdlckZhY2FkZSIsImJyaWRnZU9ic2VydmVyIiwibGlzdGVuIiwic3RvcExpc3RlbmluZyIsIm8iLCJhZGQiLCJtZXNzYWdlVHlwZSIsInJlbW92ZSIsImZyb21JZCIsInRvSWQiLCJzZW5kIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsImZpbHRlck1lc3NhZ2VJZCIsInR5cGUiLCJtZXNzYWdlT2JzZXJ2ZXJzIiwicGF5bG9hZCIsIm5vdGlmeSIsIkFycmF5IiwidW5kZWZpbmVkIiwic3VwZXIiLCJlcnJvckJyaWRnZSIsIlVuZGlyZWN0ZWRNZXNzZW5nZXIiLCJsaXN0ZW5lckJyaWRnZSIsInRhcmdldCIsInNvdXJjZSIsIlBvc3RNZXNzYWdlTGlzdGVuZXIiLCJ0YXJnZXRXaW5kb3ciLCJtZXNzYWdlT2JzZXJ2ZXIiLCJvbk1lc3NhZ2UiLCJldmVudCIsImRhdGEiLCJpZCIsIm9yaWdpbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiUG9zdE1lc3NhZ2VTZW5kZXIiLCJ0YXJnZXRPcmlnaW4iLCJfc291cmNlIiwicG9zdE1lc3NhZ2UiLCJQb3N0TWVzc2FnZUJyaWRnZSIsInNvdXJjZVdpbmRvdyIsImxpc3RlbmVyIiwic2VuZGVyIiwiUG9zdE1lc3NhZ2VGYWN0b3J5IiwicG9zdE1lc3NhZ2VCcmlkZ2UiLCJEeW5hbWljTGliTG9hZGVyIiwibGlicmFyeUNhY2hlIiwiTWFwIiwicGF0aCIsIndpbmRvd0tleSIsInNjcmlwdEZldGNoZXIiLCJnZXQiLCJTY3JpcHRGZXRjaGVyIiwic2V0IiwibGlicmFyeSIsIl9saWJyYXJ5UHJvbWlzZSIsIlByb21pc2UiLCJyZXMiLCJyZWoiLCJsaWJyYXJ5UmVzb2x2ZXIiLCJsaWJyYXJ5UmVqZWN0ZXIiLCJmZXRjaCIsInJlc3BvbnNlIiwicmVxdWVzdCIsIlJlcXVlc3QiLCJyZXF1ZXN0VXJsIiwiVVJMIiwidXJsIiwiaG9zdG5hbWUiLCJlbmRzV2l0aCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaG9zdCIsImhyZWYiLCJlIiwib2siLCJsaWIiLCJ0ZXh0IiwiRnVuY3Rpb24iLCJjYWxsIiwibGliT2JqZWN0IiwiYXNzaWduIiwiTVBfU0RLIiwiT3V0Z29pbmdNZXNzYWdlVHlwZSIsIkluY29taW5nTWVzc2FnZVR5cGUiLCJDb25uZWN0aW9uU3RhdGUiLCJsaWJMb2FkZXIiLCJjb25uZWN0IiwiY29ubmVjdG9yIiwiZmFjdG9yeUZldGNoZXIiLCJ3aW5kb3dDb250ZXh0IiwiY29ubmVjdFJlc3BvbnNlIiwiY2FuY2VsQ29ubmVjdGluZyIsImJ1aWxkZXIiLCJzZGtDbGllbnQiLCJsb2FkIiwiU2RrQnVpbGRlciIsImZldGNoU2NyaXB0Iiwic2NyaXB0VXJsIiwibWVzc2VuZ2VyRmFjdG9yeSIsImdldEZhY3RvcnkiLCJzZGtCdWlsZGVyIiwic2VyaWFsaXplZEludGVyZmFjZSIsImJ1aWxkIiwiYnVpbGRJbnRlcmZhY2UiLCJDb25uZWN0TWVzc2FnZSIsImJvb3RzdHJhcFZlcnNpb24iLCJvcHRpb25zIiwiQ09OTkVDVCIsImF1dGgiLCJwcm92aWRlciIsIkhhbmRzaGFrZU9ic2VydmVyIiwicmVjZWl2ZXIiLCJIQU5EU0hBS0UiLCJfaGFuZHNoYWtlIiwiX2NsaWVudEluZm8iLCJfdGltZXN0YW1wIiwiaGFuZHNoYWtlIiwiQWNjZXB0T2JzZXJ2ZXIiLCJBQ0NFUFQiLCJhY2NlcHQiLCJpbnRlcmZhY2UiLCJSZWplY3RPYnNlcnZlciIsIlJFSkVDVCIsInJlamVjdCIsInJlYXNvbiIsIkNvbm5lY3RvciIsImNvbm5lY3Rpb25TdGF0ZSIsIklETEUiLCJjb25uZWN0aW9uUG9sbCIsImNvbm5lY3RvckZhY2FkZSIsImhhbmRzaGFrZU9ic2VydmVyIiwiYWNjZXB0T2JzZXJ2ZXIiLCJyZWplY3RPYnNlcnZlciIsImNvbm5lY3Rpb25Qcm9taXNlIiwicmVzb2x2ZUNvbm5lY3Rpb24iLCJyZWplY3RDb25uZWN0aW9uIiwidmVyc2lvbiIsIkNPTk5FQ1RJTkciLCJzZXRJbnRlcnZhbCIsIkNPTk5FQ1RFRCIsInN0b3BDb25uZWN0UG9sbGluZyIsInJlbW92ZU9ic2VydmVyIiwiUkVKRUNURUQiLCJjbGVhckludGVydmFsIiwiZWxlbWVudCIsImNvbnRlbnRXaW5kb3ciLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJwb3N0TWVzc2FnZUxpc3RlbmVyIiwicG9zdE1lc2FnZVNlbmRlciIsImluaXQiLCJFbWJlZENvbm5lY3RvciIsIkVtYmVkTWVzc2VuZ2VyRmFjdG9yeUZldGNoZXIiLCJkaXNwb3NlIiwiSGFuZHNoYWtlTWVzc2FnZSIsIkFjY2VwdE1lc3NhZ2UiLCJjbGllbnRJbnRlcmZhY2UiLCJSZWplY3RNZXNzYWdlIiwiQ29ubmVjdE1lc3NhZ2VPYnNlcnZlciIsIm9uQ29ubmVjdGlvblJlY2VpdmVkIl0sIm1hcHBpbmdzIjoia1lBV08sTUFBTUEsRUFDWCxZQUFvQkMsR0FBQSxLQUFBQSxrQkFDYixPQUFPQyxFQUF1RUMsR0FDbkZDLEtBQUtILGdCQUFnQkksa0JBQWtCSCxFQUFTQyxJQ1g3QyxNQUFNRyxFQUFiLGNBQ1UsS0FBQUMsT0FBdUMsR0FReEMsSUFBSUMsRUFBUUMsR0FDR0wsS0FBS00sZUFBZUYsR0FDNUJHLEtBQUtGLEdBU1osT0FBT0QsRUFBUUMsR0FDcEIsTUFBTUcsRUFBY1IsS0FBS0csT0FBT0MsR0FDaEMsR0FBSUksRUFBYSxDQUNmLE1BQU1DLEVBQU1ELEVBQVlFLFFBQVFMLEdBQzVCSSxHQUFPLEdBQ1RELEVBQVlHLE9BQU9GLEVBQUssSUFTdkIsVUFBVUwsVUFDUkosS0FBS0csT0FBT0MsR0FTZCxlQUFlQSxHQUNwQixNQUFNSSxFQUFjUixLQUFLRyxP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U0FBVW9GLE9BQVFxQixFQUFnQnhHLFNBQVV6QixLQUFLNkQsT0FBUW9FLEVBQWdCdkQsZUMvQ3BILE1BQU13SCxFQUlYLGNBSGdCLEtBQUEvSSxLQUFPdUUsRUFBb0I2QixVQUl6Q3ZKLEtBQUtxRCxRQUFVLElDTFosTUFBTThJLEVBT1gsWUFBWTNELEVBQW1CNEQsRUFBMEM1SyxFQUFrQkMsRUFBa0JpRCxHQU43RixLQUFBdkIsS0FBT3VFLEVBQW9CbUMsT0FPekM3SixLQUFLcUQsUUFBVSxDQUNibUYsWUFDQXVCLFVBQVdxQyxFQUNYNUssV0FDQUMsV0FDQWlELGdCQUVGMUUsS0FBSytKLFVBQVlxQyxHQ2ZkLE1BQU1DLEVBTVgsWUFBWWxDLEdBTEksS0FBQWhILEtBQU91RSxFQUFvQnVDLE9BTXpDakssS0FBS3FELFFBQVUsQ0FDYjhHLFVBRUZuSyxLQUFLbUssT0FBU0EsR0NDWCxNQUFNbUMsRUFFWCxZQUFvQmhELEdBQUEsS0FBQUEsV0FESixLQUFBNUcsWUFBYytFLEVBQW9CeUIsUUFHM0MsT0FBT3JCLEVBQXlCOUgsR0FDckNDLEtBQUtzSixTQUFTaUQscUJBQXFCMUUsRUFBUzlIIiwiZmlsZSI6IjcxMC5pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgSU9ic2VydmVyLCBJQnJpZGdlTWVzc2FnZSB9IGZyb20gJy4vSU1lc3Nlbmdlcic7XG5pbXBvcnQgdHlwZSB7IEluZGV4S2V5IH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBDbGllbnRJbmZvIH0gZnJvbSAnLi4nO1xuXG5leHBvcnQgaW50ZXJmYWNlIElNZXNzYWdlUmVjZWl2ZXI8SW5jb21pbmdEYXRhTWFwVD4ge1xuICBvbk1lc3NhZ2VSZWNlaXZlZChtZXNzYWdlOiBJQnJpZGdlTWVzc2FnZTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4sIGNsaWVudEluZm86IENsaWVudEluZm8pOiB2b2lkO1xufVxuXG4vKipcbiAqIEFuIG9ic2VydmVyIHVzZWQgc3BlY2lmaWNhbGx5IGZvciBiaW5kaW5nIGFuIElNZXNzZW5nZXIgdG8gYW4gSU1lc3NlbmdlckJyaWRnZVxuICovXG5leHBvcnQgY2xhc3MgQnJpZGdlT2JzZXJ2ZXI8SW5jb21pbmdEYXRhTWFwVD4gaW1wbGVtZW50cyBJT2JzZXJ2ZXI8W0lCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPiwgQ2xpZW50SW5mb10+IHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBtZXNzYWdlUmVjZWl2ZXI6IElNZXNzYWdlUmVjZWl2ZXI8SW5jb21pbmdEYXRhTWFwVD4pIHsgfVxuICBwdWJsaWMgbm90aWZ5KG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPiwgY2xpZW50SW5mbzogQ2xpZW50SW5mbyk6IHZvaWQge1xuICAgIHRoaXMubWVzc2FnZVJlY2VpdmVyLm9uTWVzc2FnZVJlY2VpdmVkKG1lc3NhZ2UsIGNsaWVudEluZm8pO1xuICB9XG59XG4iLCIvKipcbiAqIEEgZGljdGlvbmFyeSBsaWtlIG9iamVjdCBvZiBhcnJheXNcbiAqL1xuZXhwb3J0IGNsYXNzIERpY3RBcnJheTxLIGV4dGVuZHMgc3RyaW5nIHwgbnVtYmVyLCBWPiB7XG4gIHByaXZhdGUgdmFsdWVzOiBSZWNvcmQ8c3RyaW5nIHwgbnVtYmVyLCBWW10+ID0ge307XG5cbiAgLyoqXG4gICAqIEFkZCBhbiBlbnRyeSB0byB0aGUgYXJyYXkgYXQgYGtleWBcbiAgICpcbiAgICogQHBhcmFtIHtLfSBrZXlcbiAgICogQHBhcmFtIHtWfSB2YWx1ZVxuICAgKi9cbiAgcHVibGljIGFkZChrZXk6IEssIHZhbHVlOiBWKTogdm9pZCB7XG4gICAgY29uc3QgdmFsdWVzQXRLZXkgPSB0aGlzLmdldFZhbHVlc0F0S2V5KGtleSk7XG4gICAgdmFsdWVzQXRLZXkucHVzaCh2YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGFuIGVudHJ5IGZyb20gdGhlIGFycmF5IGF0IGBrZXlgXG4gICAqXG4gICAqIEBwYXJhbSB7S30ga2V5XG4gICAqIEBwYXJhbSB7Vn0gdmFsdWVcbiAgICovXG4gIHB1YmxpYyByZW1vdmUoa2V5OiBLLCB2YWx1ZTogVik6IHZvaWQge1xuICAgIGNvbnN0IHZhbHVlc0F0S2V5ID0gdGhpcy52YWx1ZXNba2V5XTtcbiAgICBpZiAodmFsdWVzQXRLZXkpIHtcbiAgICAgIGNvbnN0IGlkeCA9IHZhbHVlc0F0S2V5LmluZGV4T2YodmFsdWUpO1xuICAgICAgaWYgKGlkeCA+IC0xKSB7XG4gICAgICAgIHZhbHVlc0F0S2V5LnNwbGljZShpZHgsIDEpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYWxsIHZhbHVlcyBhc3NvY2lhdGVkIHdpdGggYGtleWBcbiAgICogQHBhcmFtIHtLfSBrZXlcbiAgICovXG4gIHB1YmxpYyByZW1vdmVLZXkoa2V5OiBLKTogdm9pZCB7XG4gICAgZGVsZXRlIHRoaXMudmFsdWVzW2tleV07XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBhcnJheSBvZiB2YWx1ZXMgYXQgYGtleWBcbiAgICogV2lsbCBhbHdheXMgcmV0dXJuIGF0IGxlYXN0IGFuIGVtcHR5IGFycmF5XG4gICAqXG4gICAqIEBwYXJhbSB7S30ga2V5XG4gICAqL1xuICBwdWJsaWMgZ2V0VmFsdWVzQXRLZXkoa2V5OiBLKTogVltdIHtcbiAgICBjb25zdCB2YWx1ZXNBdEtleSA9IHRoaXMudmFsdWVzW2tleV0gfHwgW107XG4gICAgdGhpcy52YWx1ZXNba2V5XSA9IHZhbHVlc0F0S2V5O1xuICAgIHJldHVybiB2YWx1ZXNBdEtleSBhcyBWW107XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBjb3VudCBvZiB2YWx1ZXMgYXQgYGtleWBcbiAgICpcbiAgICogQHBhcmFtIHtLfSBrZXlcbiAgICovXG4gIHB1YmxpYyB2YWx1ZXNQZXJLZXkoa2V5OiBLKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5nZXRWYWx1ZXNBdEtleShrZXkpLmxlbmd0aDtcbiAgfVxuXG4gIHB1YmxpYyBmaW5kKGtleTogSywgdmFsRmluZGVyOiAodmFsOiBWKSA9PiBib29sZWFuKTogViB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMudmFsdWVzW2tleV0gJiYgdGhpcy52YWx1ZXNba2V5XS5maW5kKHZhbEZpbmRlcik7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFuIGl0ZXJhdG9yIG92ZXIgdGhlIGtleXMgaW4gdGhpcyBgRGljdEFycmF5YFxuICAgKi9cbiAgcHVibGljIGdldCBrZXlzKCk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy52YWx1ZXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRlc3QgaWYgYGtleWAgaXMgaW4gdGhpcyBgRGljdEFycmF5YFxuICAgKiBAcGFyYW0ge0t9IGtleVxuICAgKi9cbiAgcHVibGljIGhhc0tleShrZXk6IEspOiBib29sZWFuIHtcbiAgICByZXR1cm4ga2V5IGluIHRoaXMudmFsdWVzO1xuICB9XG5cbiAgLyoqXG4gICAqIFRlc3QgaWYgYSBrZXktdmFsdWUgcGFpciBpcyBpbiB0aGlzIGBEaWN0QXJyYXlgXG4gICAqIEBwYXJhbSB7S30ga2V5XG4gICAqIEBwYXJhbSB7Vn0gdmFsXG4gICAqL1xuICBwdWJsaWMgaGFzKGtleTogSywgdmFsOiBWKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaGFzS2V5KGtleSkgJiYgdGhpcy52YWx1ZXNba2V5XS5pbmNsdWRlcyh2YWwpO1xuICB9XG5cbiAgLyoqXG4gICAqIEl0ZXJhdGUgb3ZlciBhbGwgdmFsdWVzIGluIHRoaXMgYERpY3RBcnJheWBcbiAgICovXG4gIHB1YmxpYyAqW1N5bWJvbC5pdGVyYXRvcl0oKTogSXRlcmFibGVJdGVyYXRvcjxbc3RyaW5nLCBWXT4ge1xuICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMudmFsdWVzKSB7XG4gICAgICBmb3IgKGNvbnN0IHZhbCBvZiB0aGlzLnZhbHVlc1trZXldKSB7XG4gICAgICAgIHlpZWxkIFtrZXksIHZhbF07XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7IElNZXNzZW5nZXJCcmlkZ2UgfSBmcm9tICcuLi9NZXNzZW5nZXIvSU1lc3Nlbmdlcic7XG5cbi8qKlxuICogQWN0cyBhcyBhIE1lc3NlbmdlckJyaWRnZSBidXQgdGhyb3dzIGVycm9ycyBvbiBhbGwgb3V0Z29pbmcgY2FsbHMgYW5kIG5vLW9wcyBhbnkgaW5jb21pbmcgbWVzc2FnZXNcbiAqL1xuZXhwb3J0IGNsYXNzIEVycm9yTWVzc2FnZUJyaWRnZSBpbXBsZW1lbnRzIElNZXNzZW5nZXJCcmlkZ2U8dW5rbm93biwgdW5rbm93bj4ge1xuICAvKipcbiAgICogTm8tb3AgbGlzdGVuZXJcbiAgICovXG4gIHB1YmxpYyBsaXN0ZW4oKTogdm9pZCB7fVxuXG4gIC8qKlxuICAgKiBOby1vcCBzdG9wIHJlY2VpdmluZyBtZXNzYWdlXG4gICAqL1xuICBwdWJsaWMgc3RvcExpc3RlbmluZygpOiB2b2lkIHt9XG5cbiAgLyoqXG4gICAqIFRocm93IGVycm9ycyB3aGVuIGF0dGVtcHRpbmcgdG8gc2VuZCBtZXNzYWdlc1xuICAgKi9cbiAgcHVibGljIHNlbmQoKTogbmV2ZXIge1xuICAgIHRocm93IEVycm9yKCdUaGUgc2RrIGhhcyBiZWVuIGRpc2Nvbm5lY3RlZCBhbmQgY2FuXFwndCBtYWtlIGFueSBuZXcgY2FsbHMnKTtcbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUge1xuICBJTWVzc2VuZ2VyLCBJTWVzc2VuZ2VyQnJpZGdlLFxuICBJTWVzc2FnZSwgSU1lc3NhZ2VPYnNlcnZlciwgSUJyaWRnZU1lc3NhZ2UsXG4gIENsaWVudEluZm8sXG59IGZyb20gJy4vSU1lc3Nlbmdlcic7XG5pbXBvcnQgeyBCcmlkZ2VPYnNlcnZlciB9IGZyb20gJy4vQnJpZGdlT2JzZXJ2ZXInO1xuaW1wb3J0IHsgRGljdEFycmF5IH0gZnJvbSAnQG1wL3V0aWwtZGljdGFycmF5JztcbmltcG9ydCB0eXBlIHsgSW5kZXhLZXkgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBFcnJvck1lc3NhZ2VCcmlkZ2UgfSBmcm9tICcuLi9lcnJvcm1lc3NhZ2UvRXJyb3JNZXNzYWdlQnJpZGdlJztcblxuLyoqXG4gKiBBIGJpLWRpcmVjdGlvbmFsIGNvbW11bmljYXRvciB0aGF0IGNhblxuICogLSByZWNlaXZlIG1lc3NhZ2Ugb2YgdHlwZSBga2V5b2YgSW5jb21pbmdEYXRhTWFwVGAgdmlhIG9ic2VydmVyc1xuICogLSBzZW5kIG1lc3NhZ2VzIG9mIHR5cGUgYGtleW9mIE91dGdvaW5nRGF0YU1hcFRgXG4gKiAtIGZpbHRlcnMgaW5jb21pbmcgbWVzc2FnZXMgYmFzZWQgb24gdGhlIGlkIG9mIHRoZSBjbGllbnQgYW5kIHRoZSBtZXNzYWdlJ3MgdGFyZ2V0XG4gKlxuICogVGhlIHVuZGVybHlpbmcgY29tbXVuaWNhdGlvbiBtZWNoYW5pc21zIGFyZSBkZWZpbmVkIGJ5IGFuIElNZXNzZW5nZXJCcmlkZ2UgcHJvdmlkZWQgYnkgdGhlIGNyZWF0b3JcbiAqXG4gKiBAcGFyYW0gT3V0Z29pbmdEYXRhTWFwVCBUaGUgb3V0Z29pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWRcbiAqIEBwYXJhbSBJbmNvbWluZ0RhdGFNYXBUIFRoZSBpbmNvbWluZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZCBieSByZWdpc3RlcmVkIG9ic2VydmVyc1xuICovXG5leHBvcnQgY2xhc3MgTWVzc2VuZ2VyPFxuICBPdXRnb2luZ0RhdGFNYXBULFxuICBJbmNvbWluZ0RhdGFNYXBULFxuPiBpbXBsZW1lbnRzIElNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4ge1xuXG4gIHByaXZhdGUgb2JzZXJ2ZXJzOiBEaWN0QXJyYXk8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIElNZXNzYWdlT2JzZXJ2ZXI8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+PiA9IG5ldyBEaWN0QXJyYXkoKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNvdXJjZUlkOiBudW1iZXIsIHByaXZhdGUgdGFyZ2V0SWQ6IG51bWJlciwgcHJpdmF0ZSBtZXNzYWdlQnJpZGdlOiBJTWVzc2VuZ2VyQnJpZGdlPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+KSB7IH1cblxuICAvKipcbiAgICogQ2xvbmUgdGhpcyBNZXNzZW5nZXIgYXMgYW4gSU1lc3NlbmdlciB0aGF0IHdpbGwgb25seSBzZW5kIGFuZCByZWNlaXZlIGNlcnRhaW4gdHlwZXMgb2YgbWVzc2FnZXNcbiAgICogQHBhcmFtIG1lc3NlbmdlclxuICAgKiBAcGFyYW0gc2VuZEZpbHRlclxuICAgKiBAcGFyYW0gcmVjdkZpbHRlclxuICAgKiBAcmV0dXJuc1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyB0b0ZpbHRlcmVkTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+KFxuICAgIG1lc3NlbmdlcjogTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+LFxuICAgIHNlbmRGaWx0ZXI6IEFycmF5PEluZGV4S2V5PE91dGdvaW5nRGF0YU1hcFQ+PixcbiAgICByZWN2RmlsdGVyOiBBcnJheTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPj4sXG4gICk6IElNZXNzZW5nZXI8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4ge1xuICAgIGNvbnN0IGZpbHRlcmVkTWVzc2VuZ2VyID0gbmV3IEZpbHRlcmVkTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+KG1lc3Nlbmdlci5zb3VyY2VJZCwgbWVzc2VuZ2VyLnRhcmdldElkLCBtZXNzZW5nZXIsIHNlbmRGaWx0ZXIpO1xuICAgIGZvciAoY29uc3QgbXNnVHlwZSBvZiByZWN2RmlsdGVyKSB7XG4gICAgICBmb3IgKGNvbnN0IG9ic2VydmVyIG9mIG1lc3Nlbmdlci5vYnNlcnZlcnMuZ2V0VmFsdWVzQXRLZXkobXNnVHlwZSkpIHtcbiAgICAgICAgZmlsdGVyZWRNZXNzZW5nZXIuYWRkT2JzZXJ2ZXIob2JzZXJ2ZXIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmaWx0ZXJlZE1lc3NlbmdlcjtcbiAgfVxuICAvKipcbiAgICogU3RhcnQgbGlzdGVuaW5nIGZvciBhbnkgaW5jb21pbmcgbWVzc2FnZXMgdmlhIHRoZSBgbWVzc2FnZUJyaWRnZWBcbiAgICovXG4gIHB1YmxpYyBpbml0KCk6IHZvaWQge1xuICAgIGNsYXNzIE1lc3NlbmdlckZhY2FkZSB7XG4gICAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIG1lc3NlbmdlcjogTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+KSB7fVxuICAgICAgcHVibGljIG9uTWVzc2FnZVJlY2VpdmVkKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPiwgY2xpZW50SW5mbzogQ2xpZW50SW5mbykge1xuICAgICAgICB0aGlzLm1lc3Nlbmdlci5vbk1lc3NhZ2VSZWNlaXZlZChtZXNzYWdlLCBjbGllbnRJbmZvKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBtZXNzZW5nZXJGYWNhZGUgPSBuZXcgTWVzc2VuZ2VyRmFjYWRlKHRoaXMpO1xuICAgIGNvbnN0IGJyaWRnZU9ic2VydmVyID0gbmV3IEJyaWRnZU9ic2VydmVyKG1lc3NlbmdlckZhY2FkZSk7XG4gICAgdGhpcy5tZXNzYWdlQnJpZGdlLmxpc3RlbihicmlkZ2VPYnNlcnZlcik7XG4gIH1cblxuICAvKipcbiAgICogU3RvcCBsaXN0ZW5pbmcgZm9yIG1lc3NhZ2VzIGFuZCBjbGVhbiB1cCB0aGlzIE1lc3NlbmdlclxuICAgKi9cbiAgcHVibGljIGRpc3Bvc2UoKTogdm9pZCB7XG4gICAgdGhpcy5tZXNzYWdlQnJpZGdlLnN0b3BMaXN0ZW5pbmcoKTtcbiAgICB0aGlzLm1lc3NhZ2VCcmlkZ2UgPSBuZXcgRXJyb3JNZXNzYWdlQnJpZGdlKCk7XG4gIH1cblxuICAvKipcbiAgICogT2JzZXJ2ZSBpbmNvbWluZyBtZXNzYWdlc1xuICAgKlxuICAgKiBAcGFyYW0gb2JzZXJ2ZXJcbiAgICovXG4gIHB1YmxpYyBhZGRPYnNlcnZlcihvOiBJTWVzc2FnZU9ic2VydmVyPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPik6IHZvaWQge1xuICAgIHRoaXMub2JzZXJ2ZXJzLmFkZChvLm1lc3NhZ2VUeXBlLCBvKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wIGFuIG9ic2VydmVyIGZyb20gcmVjZWl2aW5nIG1lc3NhZ2VzXG4gICAqXG4gICAqIEBwYXJhbSBvYnNlcnZlclxuICAgKi9cbiAgcHVibGljIHJlbW92ZU9ic2VydmVyKG86IElNZXNzYWdlT2JzZXJ2ZXI8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+KTogdm9pZCB7XG4gICAgdGhpcy5vYnNlcnZlcnMucmVtb3ZlKG8ubWVzc2FnZVR5cGUsIG8pO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbmQgYSBgbWVzc2FnZWAgdG8gdGhlIGB0YXJnZXRgIG9mIHRoZSBgSU1lc3NlbmdlckJyaWRnZWBcbiAgICpcbiAgICogQHBhcmFtIG1lc3NhZ2VcbiAgICovXG4gIHB1YmxpYyBzZW5kKG1lc3NhZ2U6IElNZXNzYWdlPEluZGV4S2V5PE91dGdvaW5nRGF0YU1hcFQ+LCBPdXRnb2luZ0RhdGFNYXBUPik6IHZvaWQge1xuICAgIGNvbnN0IGZyb21JZCA9IHRoaXMuc291cmNlSWQ7XG4gICAgY29uc3QgdG9JZCA9IHRoaXMudGFyZ2V0SWQ7XG4gICAgdGhpcy5tZXNzYWdlQnJpZGdlLnNlbmQoe1xuICAgICAgLi4ubWVzc2FnZSxcbiAgICAgIGZyb21JZCxcbiAgICAgIHRvSWQsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogTm90aWZ5IGFsbCBvYnNlcnZlcnMgb2YgYG1lc3NhZ2UudHlwZWAgb2YgdGhlIGluY29taW5nIGBtZXNzYWdlYCBhZnRlciBhbnkgZmlsdGVyaW5nIG91dCBtZXNzYWdlcyBub3QgbWVhbnQgZm9yIHRoaXMgTWVzc2VuZ2VyXG4gICAqXG4gICAqIEBwYXJhbSBtZXNzYWdlXG4gICAqL1xuICBwcml2YXRlIG9uTWVzc2FnZVJlY2VpdmVkKG1lc3NhZ2U6IElCcmlkZ2VNZXNzYWdlPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPiwgY2xpZW50SW5mbzogQ2xpZW50SW5mbykge1xuICAgIGlmICghdGhpcy5maWx0ZXJNZXNzYWdlSWQobWVzc2FnZSkpIHJldHVybjtcblxuICAgIGNvbnN0IG1lc3NhZ2VUeXBlID0gbWVzc2FnZS50eXBlO1xuICAgIGNvbnN0IG1lc3NhZ2VPYnNlcnZlcnMgPSB0aGlzLm9ic2VydmVycy5nZXRWYWx1ZXNBdEtleShtZXNzYWdlVHlwZSk7XG4gICAgaWYgKG1lc3NhZ2VPYnNlcnZlcnMpIHtcbiAgICAgIGZvciAoY29uc3Qgb2JzZXJ2ZXIgb2YgbWVzc2FnZU9ic2VydmVycykge1xuICAgICAgICAvLyBUT0RPIChzZGsgMS54IHN1cHBvcnQpOiBTREsgYm9vdHN0cmFwIDEueCBwdXQgdGhlIHBheWxvYWQgYXQgdGhlIHJvb3Qgb2YgdGhlIG1lc3NhZ2UsIG5vdCB1bmRlciB0aGUgYHBheWxvYWRgIHByb3BlcnR5XG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBtZXNzYWdlLnBheWxvYWQgfHwgbWVzc2FnZSBhcyB1bmtub3duIGFzIEluY29taW5nRGF0YU1hcFRbRXhjbHVkZTxrZXlvZiBJbmNvbWluZ0RhdGFNYXBULCBzeW1ib2w+XTtcbiAgICAgICAgb2JzZXJ2ZXIubm90aWZ5KHBheWxvYWQsIGNsaWVudEluZm8sIG1lc3NhZ2UudGltZXN0YW1wKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lIHdoZXRoZXIgYG1lc3NhZ2VgIGlzIG1lYW50IGZvciB0aGlzIE1lc3NlbmdlciBhbmQgY29tZXMgZnJvbSBhIGtub3duIHRhcmdldFxuICAgKiBAcGFyYW0gbWVzc2FnZVxuICAgKi9cbiAgcHJpdmF0ZSBmaWx0ZXJNZXNzYWdlSWQobWVzc2FnZTogSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+KTogYm9vbGVhbiB7XG4gICAgY29uc3QgdG9JZCA9IG1lc3NhZ2UudG9JZDtcbiAgICBjb25zdCBmcm9tSWQgPSBtZXNzYWdlLmZyb21JZDtcbiAgICBpZiAodG9JZCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICByZXR1cm4gdG9JZC5pbmRleE9mKHRoaXMuc291cmNlSWQpID4gLTE7XG4gICAgfVxuXG4gICAgLy8gVE9ETyAoc2RrIDEueCBzdXBwb3J0KTogU0RLIGJvb3RzdHJhcCAxLnggaGFkIGB0b0lkYCBhcyB1bmRlZmluZWQgZm9yIG1lc3NhZ2VzXG4gICAgcmV0dXJuICh0b0lkID09PSB1bmRlZmluZWQgfHwgdG9JZCA9PT0gdGhpcy5zb3VyY2VJZCkgJiYgZnJvbUlkID09PSB0aGlzLnRhcmdldElkO1xuICB9XG59XG5cbi8qKlxuICogQSBkZWNvcmF0ZWQgSU1lc3NlbmdlciB0aGF0IG9ubHkgc2VuZHMgbWVzc2FnZXMgZnJvbSBhIHByZWRlZmluZWQgc2V0IG9mIG1lc3NhZ2UgdHlwZXMgYW5kIGVycm9ycyBvbiBvdGhlcnMuXG4gKi9cbmNsYXNzIEZpbHRlcmVkTWVzc2VuZ2VyPFxuICBPdXRnb2luZ0RhdGFNYXBULFxuICBJbmNvbWluZ0RhdGFNYXBUXG4+IGV4dGVuZHMgTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+IHtcbiAgcHJpdmF0ZSBlcnJvckJyaWRnZTogRXJyb3JNZXNzYWdlQnJpZGdlO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHNvdXJjZUlkOiBudW1iZXIsXG4gICAgdGFyZ2V0SWQ6IG51bWJlcixcbiAgICBwcml2YXRlIG1lc3NlbmdlcjogSU1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPixcbiAgICBwcml2YXRlIHNlbmRGaWx0ZXI6IEFycmF5PEluZGV4S2V5PE91dGdvaW5nRGF0YU1hcFQ+PixcbiAgKSB7XG4gICAgLy8gVE9ETyAoQG1wL3Nkayk6IHNvbWV0aGluZyBhYm91dCB0aGUgdHNjb25maWcgaW4gQG1wL3NkayByZXF1aXJlcyBgc3VwZXJgIHRvIGJlIGNhbGxlZCBmaXJzdCBzbyB0aGUgYG5ldyBFcnJvck1lc3NhZ2VCcmlkZ2VgIGNhbid0IGJlIHNoYXJlZFxuICAgIHN1cGVyKHNvdXJjZUlkLCB0YXJnZXRJZCwgbmV3IEVycm9yTWVzc2FnZUJyaWRnZSgpKTtcbiAgICB0aGlzLmVycm9yQnJpZGdlID0gbmV3IEVycm9yTWVzc2FnZUJyaWRnZSgpO1xuICB9XG5cbiAgcHVibGljIHNlbmQobWVzc2FnZTogSU1lc3NhZ2U8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4sIE91dGdvaW5nRGF0YU1hcFQ+KTogdm9pZCB7XG4gICAgaWYgKHRoaXMuc2VuZEZpbHRlci5pbmNsdWRlcyhtZXNzYWdlLnR5cGUpKSB7XG4gICAgICB0aGlzLm1lc3Nlbmdlci5zZW5kKG1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVycm9yQnJpZGdlLnNlbmQoKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHtcbiAgSVVuZGlyZWN0ZWRNZXNzZW5nZXIsIElVbmRpcmVjdGVkTWVzc2VuZ2VyTGlzdGVuZXIsIElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyLFxuICBJTWVzc2FnZSwgSU1lc3NhZ2VPYnNlcnZlciwgSUJyaWRnZU1lc3NhZ2UsXG4gIENsaWVudEluZm8sXG59IGZyb20gJy4vSU1lc3Nlbmdlcic7XG5pbXBvcnQgeyBCcmlkZ2VPYnNlcnZlciB9IGZyb20gJy4vQnJpZGdlT2JzZXJ2ZXInO1xuaW1wb3J0IHsgRGljdEFycmF5IH0gZnJvbSAnQG1wL3V0aWwtZGljdGFycmF5JztcbmltcG9ydCB0eXBlIHsgSW5kZXhLZXkgfSBmcm9tICcuLi90eXBlcyc7XG5cbi8qKlxuICogQSBiaS1kaXJlY3Rpb25hbCBjb21tdW5pY2F0b3IgdGhhdCBjYW5cbiAqIC0gb3Blbmx5IHJlY2VpdmUgbWVzc2FnZXMgb2YgdHlwZSBga2V5b2YgSW5jb21pbmdEYXRhTWFwVGAgdmlhIG9ic2VydmVycyBmcm9tIHVuc3BlY2lmaWVkIHNvdXJjZXNcbiAqIC0gc2VuZCBtZXNzYWdlcyBvZiB0eXBlIGBrZXlvZiBPdXRnb2luZ0RhdGFNYXBUYCB0byB0YXJnZXRzIHNwZWNpZmllZCB3aGVuIHNlbmRpbmdcbiAqXG4gKiAqKkRpZmZlcnMgZnJvbSBhIHN0YW5kYXJkIGBJTWVzc2VuZ2VyYCBpbiB0aGF0IGl0IGRvZXNuJ3Qga25vdyBpdCdzIGNvbW11bmljYXRpb24gdGFyZ2V0IGF0IGNvbnN0cnVjdGlvbiB0aW1lKipcbiAqXG4gKiBUaGUgdW5kZXJseWluZyBjb21tdW5pY2F0aW9uIG1lY2hhbmlzbXMgYXJlIGRlZmluZWQgYnkgYW4gYElVbmRpcmVjdGVkTWVzc2VuZ2VyTGlzdGVuZXJgIHByb3ZpZGVkIGluIHRoZSBjb25zdHJ1Y3RvclxuICogYW5kIGJ5IHRoZSBgSVVuZGlyZWN0ZWRNZXNzZW5nZXJTZW5kZXJgIHByb3ZpZGVkIGluIHNlbmRcbiAqXG4gKiBAcGFyYW0gT3V0Z29pbmdEYXRhTWFwVCBUaGUgb3V0Z29pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWRcbiAqIEBwYXJhbSBJbmNvbWluZ0RhdGFNYXBUIFRoZSBpbmNvbWluZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZCBieSByZWdpc3RlcmVkIG9ic2VydmVyc1xuICovXG5leHBvcnQgY2xhc3MgVW5kaXJlY3RlZE1lc3NlbmdlcjxcbiAgT3V0Z29pbmdEYXRhTWFwVCxcbiAgSW5jb21pbmdEYXRhTWFwVCxcbiAgU291cmNlVCxcbj4gaW1wbGVtZW50cyBJVW5kaXJlY3RlZE1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBULCBTb3VyY2VUPiB7XG5cbiAgcHJpdmF0ZSBvYnNlcnZlcnM6IERpY3RBcnJheTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4+ID0gbmV3IERpY3RBcnJheSgpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc291cmNlSWQ6IG51bWJlciwgcHJpdmF0ZSBsaXN0ZW5lckJyaWRnZTogSVVuZGlyZWN0ZWRNZXNzZW5nZXJMaXN0ZW5lcjxJbmNvbWluZ0RhdGFNYXBUPikgeyB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IGxpc3RlbmluZyBmb3IgYW55IGluY29taW5nIG1lc3NhZ2VzIHZpYSB0aGUgYGxpc3RlbmVyQnJpZGdlYFxuICAgKi9cbiAgcHVibGljIGluaXQoKTogdm9pZCB7XG4gICAgY2xhc3MgVW5kaXJlY3RlZEZhY2FkZSB7XG4gICAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIG1lc3NlbmdlcjogVW5kaXJlY3RlZE1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBULCBTb3VyY2VUPikge31cbiAgICAgIHB1YmxpYyBvbk1lc3NhZ2VSZWNlaXZlZChtZXNzYWdlOiBJQnJpZGdlTWVzc2FnZTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4sIGNsaWVudEluZm86IENsaWVudEluZm8pIHtcbiAgICAgICAgdGhpcy5tZXNzZW5nZXIub25NZXNzYWdlUmVjZWl2ZWQobWVzc2FnZSwgY2xpZW50SW5mbyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgbWVzc2VuZ2VyRmFjYWRlID0gbmV3IFVuZGlyZWN0ZWRGYWNhZGUodGhpcyk7XG4gICAgY29uc3QgYnJpZGdlT2JzZXJ2ZXIgPSBuZXcgQnJpZGdlT2JzZXJ2ZXIobWVzc2VuZ2VyRmFjYWRlKTtcbiAgICB0aGlzLmxpc3RlbmVyQnJpZGdlLmxpc3RlbihicmlkZ2VPYnNlcnZlcik7XG4gIH1cblxuICAvKipcbiAgICogU3RvcCBsaXN0ZW5pbmcgZm9yIG1lc3NhZ2VzIGFuZCBjbGVhbiB1cCB0aGlzIFVuZGlyZWN0ZWRNZXNzZW5nZXJcbiAgICovXG4gIHB1YmxpYyBkaXNwb3NlKCk6IHZvaWQge1xuICAgIHRoaXMubGlzdGVuZXJCcmlkZ2Uuc3RvcExpc3RlbmluZygpO1xuICB9XG5cbiAgLyoqXG4gICAqIE9ic2VydmUgaW5jb21pbmcgbWVzc2FnZXNcbiAgICpcbiAgICogQHBhcmFtIG9ic2VydmVyXG4gICAqL1xuICBwdWJsaWMgYWRkT2JzZXJ2ZXIob2JzZXJ2ZXI6IElNZXNzYWdlT2JzZXJ2ZXI8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+KTogdm9pZCB7XG4gICAgdGhpcy5vYnNlcnZlcnMuYWRkKG9ic2VydmVyLm1lc3NhZ2VUeXBlLCBvYnNlcnZlcik7XG4gIH1cblxuICAvKipcbiAgICogU3RvcCBhbiBvYnNlcnZlciBmcm9tIHJlY2VpdmluZyBtZXNzYWdlc1xuICAgKlxuICAgKiBAcGFyYW0gb2JzZXJ2ZXJcbiAgICovXG4gIHB1YmxpYyByZW1vdmVPYnNlcnZlcihvYnNlcnZlcjogSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4pOiB2b2lkIHtcbiAgICB0aGlzLm9ic2VydmVycy5yZW1vdmUob2JzZXJ2ZXIubWVzc2FnZVR5cGUsIG9ic2VydmVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZW5kIGEgYG1lc3NhZ2VgIHRvIHRoZSBgdGFyZ2V0YFxuICAgKlxuICAgKiBAcGFyYW0gbWVzc2FnZVxuICAgKiBAcGFyYW0gdGFyZ2V0SWRcbiAgICogQHBhcmFtIHRhcmdldFxuICAgKi9cbiAgcHVibGljIHNlbmQoXG4gICAgbWVzc2FnZTogSU1lc3NhZ2U8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4sIE91dGdvaW5nRGF0YU1hcFQ+LFxuICAgIHRhcmdldElkOiBudW1iZXIsXG4gICAgdGFyZ2V0OiBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlcjxPdXRnb2luZ0RhdGFNYXBULCB1bmtub3duPixcbiAgICBzb3VyY2U6IFNvdXJjZVQsXG4gICk6IHZvaWQge1xuICAgIHRhcmdldC5zZW5kKHtcbiAgICAgIC4uLm1lc3NhZ2UsXG4gICAgICBmcm9tSWQ6IHRoaXMuc291cmNlSWQsXG4gICAgICB0b0lkOiB0YXJnZXRJZCxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICB9LCBzb3VyY2UpO1xuICB9XG5cbiAgLyoqXG4gICAqIE5vdGlmeSBhbGwgb2JzZXJ2ZXJzIG9mIGBtZXNzYWdlLnR5cGVgIG9mIHRoZSBpbmNvbWluZyBgbWVzc2FnZWBcbiAgICpcbiAgICogQHBhcmFtIG1lc3NhZ2VcbiAgICovXG4gIHByaXZhdGUgb25NZXNzYWdlUmVjZWl2ZWQobWVzc2FnZTogSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+LCBjbGllbnRJbmZvOiBDbGllbnRJbmZvKTogdm9pZCB7XG4gICAgY29uc3QgbWVzc2FnZVR5cGUgPSBtZXNzYWdlLnR5cGU7XG4gICAgY29uc3QgbWVzc2FnZU9ic2VydmVycyA9IHRoaXMub2JzZXJ2ZXJzLmdldFZhbHVlc0F0S2V5KG1lc3NhZ2VUeXBlKTtcbiAgICBpZiAobWVzc2FnZU9ic2VydmVycykge1xuICAgICAgZm9yIChjb25zdCBvYnNlcnZlciBvZiBtZXNzYWdlT2JzZXJ2ZXJzKSB7XG4gICAgICAgIC8vIFRPRE8gKHNkayAxLnggc3VwcG9ydCk6IFNESyBCb29zdHJhcCAxLnggcHV0IHRoZSBwYXlsb2FkIGF0IHRoZSByb290IG9mIHRoZSBtZXNzYWdlXG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBtZXNzYWdlLnBheWxvYWQgfHwgbWVzc2FnZSBhcyB1bmtub3duIGFzIEluY29taW5nRGF0YU1hcFRbRXhjbHVkZTxrZXlvZiBJbmNvbWluZ0RhdGFNYXBULCBzeW1ib2w+XTtcbiAgICAgICAgb2JzZXJ2ZXIubm90aWZ5KHBheWxvYWQsIGNsaWVudEluZm8sIG1lc3NhZ2UudGltZXN0YW1wKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgUG9zdE1lc3NhZ2VDbGllbnRJbmZvIH0gZnJvbSAnLi9Qb3N0TWVzc2FnZUNsaWVudEluZm8nO1xuaW1wb3J0IHR5cGUgeyBJVW5kaXJlY3RlZE1lc3Nlbmdlckxpc3RlbmVyLCBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlciwgSU9ic2VydmVyLCBJQnJpZGdlTWVzc2FnZSwgSU1lc3NhZ2UgfSBmcm9tICcuLi9NZXNzZW5nZXIvSU1lc3Nlbmdlcic7XG5cbi8qKlxuICogQnJpZGdlcyBhbmQgYWJzdHJhY3RzIGEgd2luZG93IGFuZCBpdHMgYWRkRXZlbnRMaXN0ZW5lciBmdW5jdGlvbiB0byByZWNlaXZlIGBtZXNzYWdlYCBldmVudHNcbiAqXG4gKiBAcGFyYW0gSW5jb21pbmdEYXRhTWFwVCBUaGUgaW5jb21pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWRcbiAqL1xuZXhwb3J0IGNsYXNzIFBvc3RNZXNzYWdlTGlzdGVuZXI8XG4gIEluY29taW5nRGF0YU1hcFQsXG4+IGltcGxlbWVudHMgSVVuZGlyZWN0ZWRNZXNzZW5nZXJMaXN0ZW5lcjxJbmNvbWluZ0RhdGFNYXBUPiB7XG4gIHByaXZhdGUgbWVzc2FnZU9ic2VydmVyOiBJT2JzZXJ2ZXI8W0lNZXNzYWdlPGtleW9mIEluY29taW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+LCBQb3N0TWVzc2FnZUNsaWVudEluZm8sIG51bWJlcl0+IHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgb25NZXNzYWdlOiAoZXZlbnQ6IE1lc3NhZ2VFdmVudCkgPT4gdm9pZDtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHRhcmdldFdpbmRvdzogV2luZG93KSB7XG4gICAgLy8gc2V0IHVwIGEgY2FsbGJhY2sgdG8gdXNlIGluIGB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcmAgdGhhdCB3aWxsIHRyaWdnZXIgdGhlIHJlZ2lzdGVyZWQgb2JzZXJ2ZXJzXG4gICAgdGhpcy5vbk1lc3NhZ2UgPSAoZXZlbnQ6IE1lc3NhZ2VFdmVudDxJQnJpZGdlTWVzc2FnZTxrZXlvZiBJbmNvbWluZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPj4pID0+IHtcbiAgICAgIGlmICh0aGlzLm1lc3NhZ2VPYnNlcnZlcikge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gZXZlbnQuZGF0YTtcbiAgICAgICAgdGhpcy5tZXNzYWdlT2JzZXJ2ZXIubm90aWZ5KHtcbiAgICAgICAgICAvLyBUaGlzIHNwcmVhZCBpcyBrZXB0IGZvciBiYWNrd2FyZCBjb21wYXRpbGl0eSB3aXRoIG1lc3NlbmdlcnMgY29tcGlsZWQgaW50byBvbGRlciBzZGsgYm9vdHN0cmFwcy4uLiBzdWNrc1xuICAgICAgICAgIC4uLm1lc3NhZ2UsXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBpZDogbWVzc2FnZS5mcm9tSWQsXG4gICAgICAgICAgb3JpZ2luOiBldmVudC5vcmlnaW4sXG4gICAgICAgICAgc291cmNlOiBldmVudC5zb3VyY2UgYXMgV2luZG93LFxuICAgICAgICB9LCBldmVudC5kYXRhLnRpbWVzdGFtcCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydCByZWNlaXZpbmcgbWVzc2FnZSBldmVudHMgZnJvbSBwb3N0TWVzc2FnZVxuICAgKlxuICAgKiBAcGFyYW0gb2JzZXJ2ZXJcbiAgICovXG4gIHB1YmxpYyBsaXN0ZW4ob2JzZXJ2ZXI6IElPYnNlcnZlcjxbSU1lc3NhZ2U8a2V5b2YgSW5jb21pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4sIFBvc3RNZXNzYWdlQ2xpZW50SW5mb10+KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLm1lc3NhZ2VPYnNlcnZlcikge1xuICAgICAgdGhpcy5tZXNzYWdlT2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgIHRoaXMudGFyZ2V0V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLm9uTWVzc2FnZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFN0b3AgcmVjZWl2aW5nIG1lc3NhZ2UgZXZlbnRzIGZyb20gcG9zdE1lc3NhZ2VcbiAgICovXG4gIHB1YmxpYyBzdG9wTGlzdGVuaW5nKCk6IHZvaWQge1xuICAgIHRoaXMudGFyZ2V0V2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLm9uTWVzc2FnZSk7XG4gICAgdGhpcy5tZXNzYWdlT2JzZXJ2ZXIgPSBudWxsO1xuICB9XG59XG5cbi8qKlxuICogQnJpZGdlcyBhbmQgYWJzdHJhY3RzIGEgd2luZG93IGFuZCBpdHMgcG9zdE1lc3NhZ2UgZnVuY3Rpb24gdG8gc2VuZCBtZXNzYWdlc1xuICpcbiAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICovXG5leHBvcnQgY2xhc3MgUG9zdE1lc3NhZ2VTZW5kZXI8XG4gIE91dGdvaW5nRGF0YU1hcFQsXG4+IGltcGxlbWVudHMgSVVuZGlyZWN0ZWRNZXNzZW5nZXJTZW5kZXI8T3V0Z29pbmdEYXRhTWFwVCwgV2luZG93PiB7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSB0YXJnZXRXaW5kb3c6IFdpbmRvdywgcHJpdmF0ZSB0YXJnZXRPcmlnaW46IHN0cmluZyA9ICcqJykgeyB9XG5cbiAgLyoqXG4gICAqIFNlbmQgYSBtZXNzYWdlIG92ZXIgcG9zdE1lc3NhZ2UgdG8gdGhlIGB0YXJnZXRXaW5kb3dgXG4gICAqXG4gICAqIEBwYXJhbSBtZXNzYWdlXG4gICAqL1xuICBwdWJsaWMgc2VuZChtZXNzYWdlOiBJQnJpZGdlTWVzc2FnZTxrZXlvZiBPdXRnb2luZ0RhdGFNYXBULCBPdXRnb2luZ0RhdGFNYXBUPiwgX3NvdXJjZTogV2luZG93KTogdm9pZCB7XG4gICAgdGhpcy50YXJnZXRXaW5kb3cucG9zdE1lc3NhZ2UobWVzc2FnZSwgdGhpcy50YXJnZXRPcmlnaW4pO1xuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7IElNZXNzZW5nZXJCcmlkZ2UsIElNZXNzYWdlLCBJT2JzZXJ2ZXIsIElCcmlkZ2VNZXNzYWdlLCBJVW5kaXJlY3RlZE1lc3Nlbmdlckxpc3RlbmVyLCBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlciB9IGZyb20gJy4uL01lc3Nlbmdlci9JTWVzc2VuZ2VyJztcbmltcG9ydCB7IFBvc3RNZXNzYWdlTGlzdGVuZXIsIFBvc3RNZXNzYWdlU2VuZGVyIH0gZnJvbSAnLi9VbmRpcmVjdGVkUG9zdE1lc3NhZ2VCcmlkZ2UnO1xuaW1wb3J0IHR5cGUgeyBJbmRleEtleSB9IGZyb20gJy4uL3R5cGVzJztcblxuLyoqXG4gKiBCcmlkZ2VzIGFuZCBzZXRzIHVwIGEgZGlyZWN0IGNoYW5uZWwgYmV0d2VlbiB0d28gV2luZG93cyB1c2luZyBwb3N0TWVzc2FnZVxuICpcbiAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICogQHBhcmFtIEluY29taW5nRGF0YU1hcFQgVGhlIGluY29taW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkXG4gKi9cbmV4cG9ydCBjbGFzcyBQb3N0TWVzc2FnZUJyaWRnZTxcbiAgT3V0Z29pbmdEYXRhTWFwVCxcbiAgSW5jb21pbmdEYXRhTWFwVCxcbj4gaW1wbGVtZW50cyBJTWVzc2VuZ2VyQnJpZGdlPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+IHtcbiAgcHJpdmF0ZSBsaXN0ZW5lcjogSVVuZGlyZWN0ZWRNZXNzZW5nZXJMaXN0ZW5lcjxJbmNvbWluZ0RhdGFNYXBUPjtcbiAgcHJpdmF0ZSBzZW5kZXI6IElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyPE91dGdvaW5nRGF0YU1hcFQsIFdpbmRvdz47XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBzb3VyY2VXaW5kb3c6IFdpbmRvdywgdGFyZ2V0V2luZG93OiBXaW5kb3csIHRhcmdldE9yaWdpbjogc3RyaW5nID0gJyonKSB7XG4gICAgdGhpcy5saXN0ZW5lciA9IG5ldyBQb3N0TWVzc2FnZUxpc3RlbmVyKHNvdXJjZVdpbmRvdyk7XG4gICAgdGhpcy5zZW5kZXIgPSBuZXcgUG9zdE1lc3NhZ2VTZW5kZXIodGFyZ2V0V2luZG93LCB0YXJnZXRPcmlnaW4pO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IHJlY2VpdmluZyBtZXNzYWdlIGV2ZW50cyBmcm9tIHBvc3RNZXNzYWdlXG4gICAqXG4gICAqIEBwYXJhbSBvYnNlcnZlclxuICAgKi9cbiAgcHVibGljIGxpc3RlbihvYnNlcnZlcjogSU9ic2VydmVyPFtJTWVzc2FnZTxrZXlvZiBJbmNvbWluZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPl0+KTogdm9pZCB7XG4gICAgdGhpcy5saXN0ZW5lci5saXN0ZW4ob2JzZXJ2ZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3AgcmVjZWl2aW5nIG1lc3NhZ2UgZXZlbnRzIGZyb20gcG9zdE1lc3NhZ2VcbiAgICovXG4gIHB1YmxpYyBzdG9wTGlzdGVuaW5nKCk6IHZvaWQge1xuICAgIHRoaXMubGlzdGVuZXIuc3RvcExpc3RlbmluZygpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbmQgYSBtZXNzYWdlIG92ZXIgcG9zdE1lc3NhZ2UgdG8gdGhlIGB0YXJnZXRXaW5kb3dgXG4gICAqXG4gICAqIEBwYXJhbSBtZXNzYWdlXG4gICAqL1xuICBwdWJsaWMgc2VuZChtZXNzYWdlOiBJQnJpZGdlTWVzc2FnZTxJbmRleEtleTxPdXRnb2luZ0RhdGFNYXBUPiwgT3V0Z29pbmdEYXRhTWFwVD4pOiB2b2lkIHtcbiAgICB0aGlzLnNlbmRlci5zZW5kKG1lc3NhZ2UsIHRoaXMuc291cmNlV2luZG93KTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgTWVzc2VuZ2VyIH0gZnJvbSAnLi4vTWVzc2VuZ2VyL01lc3Nlbmdlcic7XG5pbXBvcnQgdHlwZSB7IElNZXNzZW5nZXJGYWN0b3J5LCBJTWVzc2VuZ2VyIH0gZnJvbSAnLi4vTWVzc2VuZ2VyL0lNZXNzZW5nZXInO1xuaW1wb3J0IHsgUG9zdE1lc3NhZ2VCcmlkZ2UgfSBmcm9tICcuL1Bvc3RNZXNzYWdlQnJpZGdlJztcblxuLyoqXG4gKiBBIHNpbXBsZSBmYWN0b3J5IHRvIGNyZWF0ZSBQb3N0TWVzc2FnZSB0byBoaWRlIGF3YXkgdGhlIGRldGFpbHMgb2YgaWRzIGFuZCBzb3VyY2UvYXJnZXQgV2luZG93IGluZm9ybWF0aW9uXG4gKi9cbmV4cG9ydCBjbGFzcyBQb3N0TWVzc2FnZUZhY3Rvcnk8T3V0Z29pbmdEYXRhTWFwVCwgSW5jb21pbmdEYXRhTWFwVD4gaW1wbGVtZW50cyBJTWVzc2VuZ2VyRmFjdG9yeTxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPiAge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHNvdXJjZUlkOiBudW1iZXIsIHByaXZhdGUgc291cmNlV2luZG93OiBXaW5kb3csXG4gICAgcHJpdmF0ZSB0YXJnZXRJZDogbnVtYmVyLCBwcml2YXRlIHRhcmdldFdpbmRvdzogV2luZG93LCBwcml2YXRlIHRhcmdldE9yaWdpbjogc3RyaW5nID0gJyonKSB7IH1cblxuICAvKipcbiAgICogQ3JlYXRlIGEgUG9zdE1lc3NhZ2UgY2hhbm5lbFxuICAgKiBAcGFyYW0gT3V0Z29pbmdEYXRhTWFwVCBUaGUgb3V0Z29pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWQgYnkgdGhlIG5ld2x5IGNyZWF0ZWQgSU1lc3NlbmdlclxuICAgKiBAcGFyYW0gT3V0Z29pbmdEYXRhTWFwVCBUaGUgaW5jb21pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWQgYnkgdGhlIG5ld2x5IGNyZWF0ZWQgSU1lc3NlbmdlclxuICAgKi9cbiAgcHVibGljIGNyZWF0ZU1lc3NlbmdlcigpOiBJTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+IHtcbiAgICBjb25zdCBwb3N0TWVzc2FnZUJyaWRnZSA9IG5ldyBQb3N0TWVzc2FnZUJyaWRnZTxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPih0aGlzLnNvdXJjZVdpbmRvdywgdGhpcy50YXJnZXRXaW5kb3csIHRoaXMudGFyZ2V0T3JpZ2luKTtcbiAgICBjb25zdCBtZXNzZW5nZXIgPSBuZXcgTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+KHRoaXMuc291cmNlSWQsIHRoaXMudGFyZ2V0SWQsIHBvc3RNZXNzYWdlQnJpZGdlKTtcbiAgICByZXR1cm4gbWVzc2VuZ2VyO1xuICB9XG59XG4iLCIvKipcclxuICogQSBsb2FkZXIgZm9yIGZldGNoaW5nIHJlbW90ZSBzY3JpcHRzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRHluYW1pY0xpYkxvYWRlciB7XHJcbiAgcHJpdmF0ZSBsaWJyYXJ5Q2FjaGUgPSBuZXcgTWFwPHN0cmluZywgU2NyaXB0RmV0Y2hlcjx1bmtub3duPj4oKTtcclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYSBsaWJyYXJ5IGZyb20gYHBhdGhgXHJcbiAgICpcclxuICAgKiBAcGFyYW0gcGF0aFxyXG4gICAqIEBwYXJhbSB3aW5kb3dLZXkgSWYgV2VicGFjayBidWlsdCB0aGUgbGlicmFyeSB1c2luZyBgbGlicmFyeVRhcmdldDogJ3dpbmRvdydgLCB0aGlzIGlzIHRoZSBgbGlicmFyeWAgcGFyYW0gaW4gdGhlIHdlYnBhY2sgY29uZmlnXHJcbiAgICovXHJcbiAgcHVibGljIGxvYWQ8VD4ocGF0aDogc3RyaW5nLCB3aW5kb3dLZXk/OiBzdHJpbmcpOiBQcm9taXNlPFQ+IHtcclxuICAgIGNvbnN0IHNjcmlwdEZldGNoZXIgPSB0aGlzLmxpYnJhcnlDYWNoZS5nZXQocGF0aCkgYXMgU2NyaXB0RmV0Y2hlcjxUPiB8fCBuZXcgU2NyaXB0RmV0Y2hlcjxUPihwYXRoLCB3aW5kb3dLZXkpO1xyXG4gICAgdGhpcy5saWJyYXJ5Q2FjaGUuc2V0KHBhdGgsIHNjcmlwdEZldGNoZXIpO1xyXG5cclxuICAgIHJldHVybiBzY3JpcHRGZXRjaGVyLmxpYnJhcnk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRmV0Y2hlcyBhIHNjcmlwdFxyXG4gKi9cclxuY2xhc3MgU2NyaXB0RmV0Y2hlcjxUPiB7XHJcbiAgcHJpdmF0ZSBsaWJyYXJ5UmVzb2x2ZXIhOiAobGliOiBUKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgbGlicmFyeVJlamVjdGVyITogKGVycjogc3RyaW5nKSA9PiB2b2lkO1xyXG4gIHByaXZhdGUgX2xpYnJhcnlQcm9taXNlOiBQcm9taXNlPFQ+O1xyXG5cclxuICBjb25zdHJ1Y3RvcihwYXRoOiBzdHJpbmcsIHdpbmRvd0tleT86IHN0cmluZykge1xyXG4gICAgdGhpcy5fbGlicmFyeVByb21pc2UgPSBuZXcgUHJvbWlzZTxUPigocmVzLCByZWopID0+IHtcclxuICAgICAgdGhpcy5saWJyYXJ5UmVzb2x2ZXIgPSByZXM7XHJcbiAgICAgIHRoaXMubGlicmFyeVJlamVjdGVyID0gcmVqO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLmZldGNoKHBhdGgsIHdpbmRvd0tleSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGZldGNoKHBhdGg6IHN0cmluZywgd2luZG93S2V5Pzogc3RyaW5nKSB7XHJcbiAgICBsZXQgcmVzcG9uc2U6IFJlc3BvbnNlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KHBhdGgpO1xyXG4gICAgICBjb25zdCByZXF1ZXN0VXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XHJcbiAgICAgIGlmICghcmVxdWVzdFVybC5ob3N0bmFtZS5lbmRzV2l0aCh3aW5kb3cubG9jYXRpb24uaG9zdG5hbWUpICYmXHJcbiAgICAgICAgICAhcmVxdWVzdFVybC5ob3N0LmVuZHNXaXRoKCdtYXR0ZXJwb3J0LmNvbScpICYmXHJcbiAgICAgICAgICAhcmVxdWVzdFVybC5ob3N0LmVuZHNXaXRoKCdtYXR0ZXJwb3J0dnIuY24nKSkge1xyXG4gICAgICAgIHRoaXMubGlicmFyeVJlamVjdGVyKGBSZXF1ZXN0IG1hZGUgZm9yICR7cmVxdWVzdFVybC5ocmVmfSBkb2VzIG5vdCBoYXZlIHRoZSBzYW1lIG9yaWdpbiBhcyB0aGUgcmVxdWVzdCBvcmlnaW4gJHt3aW5kb3cubG9jYXRpb24ub3JpZ2lufWApO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChuZXcgUmVxdWVzdChwYXRoLCB7XHJcbiAgICAgICAgLy8gVE9ETzogaXQgd291bGQgYmUgbmljZSBpZiAnc2FtZS1zaXRlJyB3YXMgc3VwcG9ydGVkIGJ1dCBpdCBpc24ndDtcclxuICAgICAgICAvLyAuLi4gc2luY2UgdGhlIFNob3djYXNlIGlmcmFtZSB3aWxsIGJlIGF0IHFhMy4gb3IgbXkuIHN1YmRvbWFpbnMsIHNhbWUtb3JpZ2luIHdpbGwgYnJlYWsgZm9yIHN0YXRpYy5tYXR0ZXJwb3J0IGZldGNoZXMuXHJcbiAgICAgICAgLy8gbW9kZTogJ3NhbWUtb3JpZ2luJyxcclxuICAgICAgfSkpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICB0aGlzLmxpYnJhcnlSZWplY3RlcihlKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgdGhpcy5saWJyYXJ5UmVqZWN0ZXIoJ1NjcmlwdCBub3QgZm91bmQuJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBleGVjdXRlIHRoZSByZXBzb25zZSAod2hpY2ggaXMgdGhlIGxpYnJhcnkncyB0ZXh0KSBhbmQgYXR0YWNoIHRoZSByZXN1bHQgdG8gdGhlIGBsaWJgIG9iamVjdFxyXG4gICAgY29uc3QgbGliID0ge30gYXMgVDtcclxuICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XHJcbiAgICBuZXcgRnVuY3Rpb24odGV4dCkuY2FsbChsaWIpO1xyXG5cclxuICAgIC8vIGlmIHRoZSBgd2luZG93S2V5YCBhcmcgd2FzIHByb3ZpZGVkIGFuZCB0aGUgbGlicmFyeSdzIGNvbnRlbnRzIHdlcmUgYXR0YWNoZWQgdG8gdGhlIHdpbmRvdywgYXNzaWduIHRoYXQgdG8gdGhlIGBsaWJgIG9iamVjdFxyXG4gICAgaWYgKHdpbmRvd0tleSAmJiB3aW5kb3dLZXkgaW4gd2luZG93KSB7XHJcbiAgICAgIGNvbnN0IGxpYk9iamVjdCA9IHdpbmRvd1t3aW5kb3dLZXkgYXMga2V5b2YgV2luZG93XSB8fCB7fTtcclxuICAgICAgT2JqZWN0LmFzc2lnbihsaWIsIGxpYk9iamVjdCk7XHJcbiAgICAgIGRlbGV0ZSB3aW5kb3dbd2luZG93S2V5IGFzIGtleW9mIFdpbmRvd107XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5saWJyYXJ5UmVzb2x2ZXIobGliKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEEgcHJvbWlzZSBvZiB0aGUgbGlicmFyeSBiZWluZyBsb2FkZWRcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0IGxpYnJhcnkoKTogUHJvbWlzZTxUPiB7XHJcbiAgICByZXR1cm4gdGhpcy5fbGlicmFyeVByb21pc2U7XHJcbiAgfVxyXG5cclxufVxyXG4iLCJpbXBvcnQgdHlwZSB7IENvbm5lY3RSZXNwb25zZSB9IGZyb20gJy4vQ29ubmVjdG9yJztcbmltcG9ydCB0eXBlIHsgSU1lc3NlbmdlckZhY3RvcnkgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuXG5pbXBvcnQgdHlwZSB7IE1wU2RrIH0gZnJvbSAnQHNkay90eXBlcyc7XG5pbXBvcnQgeyBEeW5hbWljTGliTG9hZGVyIH0gZnJvbSAnZHluYW1pYy1saWItbG9hZGVyJztcblxudHlwZSBEaWN0PFQgPSB1bmtub3duPiA9IFJlY29yZDxzdHJpbmcsIFQgfCB1bmRlZmluZWQ+O1xuXG4vLyBkZWNsYXJlIGNsYXNzIGlzIGxpa2UgZGVmaW5pbmcgYW4gaW50ZXJmYWNlLCBidXQgaXQgY2FuIGhhdmUgYSBjb25zdHJ1Y3RvclxuLy8gaXQncyBzaW1pbGFyIHRvIGBleHRlcm5gLCB3aGVyZSB0aGlzIGNsYXNzIGlzIGZ1bGx5IGRlZmluZWQgYW5kIGltcGxlbWVudGVkIGVsc2V3aGVyZVxuZGVjbGFyZSBjbGFzcyBTZGtCdWlsZGVyPE91dGdvaW5nRGF0YU1hcFQgPSB1bmtub3duLCBJbmNvbWluZ0RhdGFNYXBUID0gdW5rbm93bj4ge1xuICBjb25zdHJ1Y3RvcihtZXNzZW5nZXJGYWN0b3J5OiBJTWVzc2VuZ2VyRmFjdG9yeTxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPiwgd2luZG93Q29udGV4dDogV2luZG93KTtcbiAgcHVibGljIGJ1aWxkKHNlcmlhbGl6ZWRJbnRlcmZhY2U6IERpY3QpOiBNcFNkaztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJU2RrQ29ubmVjdG9yPFQgZXh0ZW5kcyBDb25uZWN0UmVzcG9uc2U+IHtcbiAgY29ubmVjdCgpOiBQcm9taXNlPFQ+O1xuICBjYW5jZWxDb25uZWN0aW5nKCk6IHZvaWQ7XG59XG5cbmV4cG9ydCB0eXBlIE1lc3NlbmdlckZhY3RvcnlGZXRjaGVyPENvbm5lY3RSZXNwb25zZVQgZXh0ZW5kcyBDb25uZWN0UmVzcG9uc2UsIE91dXRnb2luZ0RhdGFNYXAsIEluY29taW5nRGF0YU1hcD4gPSB7XG4gIGdldEZhY3RvcnkoY29ubmVjdFJlc3BvbnNlOiBDb25uZWN0UmVzcG9uc2VUKTogSU1lc3NlbmdlckZhY3Rvcnk8T3V1dGdvaW5nRGF0YU1hcCwgSW5jb21pbmdEYXRhTWFwPjtcbn07XG5cbmV4cG9ydCBuYW1lc3BhY2UgTVBfU0RLIHtcbiAgY29uc3QgbGliTG9hZGVyID0gbmV3IER5bmFtaWNMaWJMb2FkZXIoKTtcbiAgZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbm5lY3Q8VCBleHRlbmRzIENvbm5lY3RSZXNwb25zZSA9IENvbm5lY3RSZXNwb25zZSwgT3V0Z29pbmdEYXRhTWFwID0gdW5rbm93biwgSW5jb21pbmdEYXRhTWFwID0gdW5rbm93bj4oXG4gICAgY29ubmVjdG9yOiBJU2RrQ29ubmVjdG9yPFQ+LFxuICAgIGZhY3RvcnlGZXRjaGVyOiBNZXNzZW5nZXJGYWN0b3J5RmV0Y2hlcjxULCBPdXRnb2luZ0RhdGFNYXAsIEluY29taW5nRGF0YU1hcD4sXG4gICAgd2luZG93Q29udGV4dDogV2luZG93LFxuICApOiBQcm9taXNlPE1wU2RrPiB7XG4gICAgbGV0IGNvbm5lY3RSZXNwb25zZTogVDtcbiAgICB0cnkge1xuICAgICAgY29ubmVjdFJlc3BvbnNlID0gYXdhaXQgY29ubmVjdG9yLmNvbm5lY3QoKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgLy8gYWZ0ZXIgYSBjb25uZWN0aW9uIGlzIHN1Y2Nlc3NmdWwgb3Igbm90LCBzaHV0ZG93biB0aGUgY29ubmVjdG9yIGFuZCBpdHMgcG9zdG1lc3NhZ2UgcmVjZWl2aW5nIG1lc3NhZ2VzXG4gICAgICBjb25uZWN0b3IuY2FuY2VsQ29ubmVjdGluZygpO1xuICAgIH1cblxuICAgIC8vIGZldGNoIGFuZCBidWlsZCB0aGUgY2xpZW50IGludGVyZmFjZVxuICAgIGNvbnN0IGJ1aWxkZXIgPSBhd2FpdCBmZXRjaFNjcmlwdChjb25uZWN0UmVzcG9uc2Uuc2NyaXB0VXJsKTtcbiAgICAvLyBzZXQgdXAgYSBmYWN0b3J5IHNvIHRoYXQgdGhlIGNsaWVudCBjYW4gY3JlYXRlIE1lc3NlbmdlciBjaGFubmVsc1xuICAgIGNvbnN0IG1lc3NlbmdlckZhY3RvcnkgPSBmYWN0b3J5RmV0Y2hlci5nZXRGYWN0b3J5KGNvbm5lY3RSZXNwb25zZSk7XG4gICAgLy8gYnVpbGQgYW5kIHJldHVybiB0aGUgY2xpZW50IGludGVyZmFjZSB0byB0aGUgdXNlclxuICAgIHJldHVybiBidWlsZEludGVyZmFjZSh3aW5kb3dDb250ZXh0LCBidWlsZGVyLCBtZXNzZW5nZXJGYWN0b3J5LCBjb25uZWN0UmVzcG9uc2Uuc2VyaWFsaXplZEludGVyZmFjZSk7XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBmZXRjaFNjcmlwdCh1cmw/OiBzdHJpbmcpOiBQcm9taXNlPHR5cGVvZiBTZGtCdWlsZGVyPiB7XG4gICAgaWYgKCF1cmwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlZCB0byBsb2FkIHRoZSBzZGsnKTtcbiAgICB9XG5cbiAgICAvLyBmZXRjaCBhbmQgY2FjaGUgdGhlIHByb21pc2UgZm9yIHRoZSByZXF1ZXN0ZWQgc2NyaXB0XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNka0NsaWVudCA9IGF3YWl0IGxpYkxvYWRlci5sb2FkPHtTZGtCdWlsZGVyOiB0eXBlb2YgU2RrQnVpbGRlcn0+KHVybCwgJ3Nkay1jbGllbnQnKTtcbiAgICAgIGlmIChzZGtDbGllbnQgJiYgc2RrQ2xpZW50LlNka0J1aWxkZXIgJiYgdHlwZW9mIHNka0NsaWVudC5TZGtCdWlsZGVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiBzZGtDbGllbnQuU2RrQnVpbGRlcjtcbiAgICAgIH1cbiAgICB9IGNhdGNoIHtcbiAgICAgIC8vIGNhdGNoIGFsbCBhbmQgXCJpZ25vcmVcIiwgc2luY2Ugd2UnbGwgdGhyb3cgc2hvcnRseSBhbnl3YXlcbiAgICB9XG4gICAgdGhyb3cgRXJyb3IoYENvdWxkIG5vdCBsb2FkIHRoZSBzZGsgZnJvbSAke3VybH1gKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGJ1aWxkSW50ZXJmYWNlPE91dGdvaW5nRGF0YU1hcFQsIEluY29taW5nRGF0YU1hcFQ+KFxuICAgIHdpbmRvd0NvbnRleHQ6IFdpbmRvdyxcbiAgICBzZGtCdWlsZGVyOiB0eXBlb2YgU2RrQnVpbGRlcixcbiAgICBtZXNzZW5nZXJGYWN0b3J5OiBJTWVzc2VuZ2VyRmFjdG9yeTxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPixcbiAgICBzZXJpYWxpemVkSW50ZXJmYWNlOiBEaWN0LFxuICApOiBSZXR1cm5UeXBlPFNka0J1aWxkZXJbJ2J1aWxkJ10+IHtcbiAgICByZXR1cm4gbmV3IHNka0J1aWxkZXIobWVzc2VuZ2VyRmFjdG9yeSwgd2luZG93Q29udGV4dCkuYnVpbGQoc2VyaWFsaXplZEludGVyZmFjZSk7XG4gIH1cbn1cbiIsIi8vIC0tLS0tLS0tLS0tLS0tLS0tIE91dGdvaW5nIE1lc3NhZ2VzIC0tLS0tLS0tLS0tLS0tLS0tIC8vXG5leHBvcnQgZW51bSBPdXRnb2luZ01lc3NhZ2VUeXBlIHtcbiAgQ09OTkVDVCA9ICdwb3N0bWVzc2FnZS5jb25uZWN0Jyxcbn1cblxuLyoqXG4gKiBUaGUgZGF0YSBwYXlsb2FkIG9mIGEgQ29ubmVjdCBtZXNzYWdlXG4gKi9cbmV4cG9ydCB0eXBlIENvbm5lY3RQYXlsb2FkID0ge1xuICAvKiogVGhlIHZlcnNpb24gb2YgdGhlIHNkayBib290c3RyYXAgYXR0ZW1wdGluZyB0byBjb25uZWN0ICovXG4gIGJvb3RzdHJhcFZlcnNpb246IHN0cmluZztcbiAgb3B0aW9uczoge1xuICAgIC8qKiBBbiBhdXRoIHRva2VuICovXG4gICAgYXV0aD86IHN0cmluZztcblxuICAgIC8qKiBwcm92aWRlciBuYW1lICovXG4gICAgcHJvdmlkZXI/OiBzdHJpbmc7XG4gIH0sXG4gIC8vIFRPRE8gKHNkayk6IHNkayBib290c3RyYXAgdjIueCBwYXNzZWQgdGhlIGFwcGxpY2F0aW9uS2V5OyByZW1vdmUgdGhpcyB3aGVuIHRob3NlIHZlcnNpb25zIGFyZSBubyBsb25nZXIgc3VwcG9ydGVkXG4gIGFwcGxpY2F0aW9uS2V5Pzogc3RyaW5nO1xufTtcblxuLyoqXG4gKiBBIG1hcCBiZXR3ZWVuIHRoZSBvdXRnb2luZyBtZXNzYWdlcyB0eXBlcyBhbmQgdGhlIGRhdGEgYXNzb2NpYXRlZCB3aXRoIHRoZSBtZXNzYWdlXG4gKi9cbmV4cG9ydCB0eXBlIE91dGdvaW5nRGF0YU1hcCA9IHtcbiAgW091dGdvaW5nTWVzc2FnZVR5cGUuQ09OTkVDVF06IENvbm5lY3RQYXlsb2FkLFxufTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0gSW5jb21pbmcgTWVzc2FnZXMgLS0tLS0tLS0tLS0tLS0tLS0gLy9cbmV4cG9ydCBlbnVtIEluY29taW5nTWVzc2FnZVR5cGUge1xuICBIQU5EU0hBS0UgPSAncG9zdG1lc3NhZ2UuaGFuZHNoYWtlJyxcbiAgQUNDRVBUICAgID0gJ3Bvc3RtZXNzYWdlLmFjY2VwdCcsXG4gIFJFSkVDVCAgICA9ICdwb3N0bWVzc2FnZS5yZWplY3QnLFxufVxuXG4vKipcbiAqIFRoZSBkYXRhIG9mIGEgbWVzc2FnZSBzaWduYWxsaW5nIHRoYXQgdGhlIGNvbm5lY3Rpb24gd2FzIChtb3N0bHkpIGFjY2VwdGVkIGJ1dCBoYXNuJ3QgYmVlbiBmaW5hbGl6ZWQgeWV0XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSGFuZHNoYWtlUGF5bG9hZCB7XG4gIC8qKiBETyBOT1QgVVNFOiBQbGFjZWhvbGRlciB0byBtYWtlIHRoaXMgdHlwZSB1bmlxdWUgZnJvbSBvdGhlciBtZXNzYWdlIERhdGEgdHlwZXMgKi9cbiAgdW51c2VkPzogJ2hhbmRzaGFrZS5kYXRhJztcbn1cblxuLyoqXG4gKiBUaGUgZGF0YSBvZiBhIG1lc3NhZ2Ugc2lnbmFsbGluZyB0aGUgY29ubmVjdGlvbiB0byB0aGUgaG9zdCB3YXMgYWNjZXB0ZWRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBY2NlcHRQYXlsb2FkIHtcbiAgLyoqIFRoZSBpZCB0aGF0IHdhcyBhc3NpZ25lZCB0byB0aGllIGNsaWVudCBiZWhpbmQgdGhpcyBjb25uZWN0aW9uICovXG4gIHNvdXJjZUlkOiBudW1iZXI7XG4gIC8qKiBUaGUgcmVtb3RlIHVybCBvZiB0aGUgY2xpZW50IHNjcmlwdCB0byBiZSBkeW5hbWljYWxseSBsb2FkZWQgKi9cbiAgc2NyaXB0VXJsOiBzdHJpbmc7XG4gIC8qKiBUaGUgc2VyaWFsaXplZCBpbnRlcmZhY2UgdGhhdCB0aGUgaG9zdCBzdXBwb3J0cyAqL1xuICBpbnRlcmZhY2U6IFJlY29yZDxzdHJpbmcsIHVua25vd24gfCB1bmRlZmluZWQ+O1xuICAvKiogVGhlIGlkIG9mIHRoZSBob3N0IHRoYXQgYWNjZXB0ZWQgdGhlIGNvbm5lY3Rpb24gKi9cbiAgdGFyZ2V0SWQ6IG51bWJlcjtcbiAgLyoqIFRoZSBvcmlnaW4gb2YgdGhlIGhvc3QgdGhhdCBhY2NlcHRlZCB0aGUgY29ubmVjdGlvbiAqL1xuICB0YXJnZXRPcmlnaW46IHN0cmluZztcbn1cblxuLyoqXG4gKiBUaGUgZGF0YSBvZiBhIG1lc3NhZ2Ugc2lnbmFsbGluZyB0aGF0IHRoZSBjb25uZWN0aW9uIHdhcyByZWplY3RlZCBvciBmYWlsZWRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSZWplY3RQYXlsb2FkIHtcbiAgLyoqIFRoZSBlcnJvciBtZXNzYWdlIHdoeSBjb25uZWN0aW5nIGZhaWxlZCAqL1xuICByZWFzb246IHN0cmluZztcbn1cblxuLyoqXG4gKiBBIG1hcCBiZXR3ZWVuIHRoZSBpbmNvbWluZyBtZXNzYWdlcyB0eXBlcyBhbmQgdGhlIGRhdGEgYXNzb2NpYXRlZCB3aXRoIHRoZSBtZXNzYWdlXG4gKi9cbmV4cG9ydCB0eXBlIEluY29taW5nRGF0YU1hcCA9IHtcbiAgW0luY29taW5nTWVzc2FnZVR5cGUuSEFORFNIQUtFXTogSGFuZHNoYWtlUGF5bG9hZDtcbiAgW0luY29taW5nTWVzc2FnZVR5cGUuQUNDRVBUXTogQWNjZXB0UGF5bG9hZDtcbiAgW0luY29taW5nTWVzc2FnZVR5cGUuUkVKRUNUXTogUmVqZWN0UGF5bG9hZDtcbn07XG4iLCJpbXBvcnQgdHlwZSB7IElVbmRpcmVjdGVkTWVzc2VuZ2VyLCBJVW5kaXJlY3RlZE1lc3NlbmdlclNlbmRlcn0gZnJvbSAnQHNkay9tZXNzZW5nZXJzJztcbmltcG9ydCB7IEFOWV9UQVJHRVQgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUgeyBDb25uZWN0T3B0aW9ucyB9IGZyb20gJ0BzZGsvdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBPdXRnb2luZ0RhdGFNYXAsIEluY29taW5nRGF0YU1hcCB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5pbXBvcnQgeyBDb25uZWN0TWVzc2FnZSB9IGZyb20gJy4uL01lc3NhZ2VzL0Nvbm5lY3RNZXNzYWdlJztcbmltcG9ydCB7IEhhbmRzaGFrZU9ic2VydmVyIH0gZnJvbSAnLi4vTWVzc2FnZU9ic2VydmVycy9IYW5kc2hha2VPYnNlcnZlcic7XG5pbXBvcnQgeyBBY2NlcHRPYnNlcnZlciB9IGZyb20gJy4uL01lc3NhZ2VPYnNlcnZlcnMvQWNjZXB0T2JzZXJ2ZXInO1xuaW1wb3J0IHsgUmVqZWN0T2JzZXJ2ZXIgfSBmcm9tICcuLi9NZXNzYWdlT2JzZXJ2ZXJzL1JlamVjdE9ic2VydmVyJztcblxudHlwZSBEaWN0PFQgPSB1bmtub3duPiA9IFJlY29yZDxzdHJpbmcsIFQgfCB1bmRlZmluZWQ+O1xuXG5lbnVtIENvbm5lY3Rpb25TdGF0ZSB7XG4gIElETEUsXG4gIENPTk5FQ1RJTkcsXG4gIEhBTkRTSEFLRSxcbiAgQ09OTkVDVEVELFxuICBSRUpFQ1RFRCxcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb25uZWN0UmVzcG9uc2Uge1xuICBzb3VyY2VJZDogbnVtYmVyO1xuICB0YXJnZXRJZDogbnVtYmVyO1xuICB0YXJnZXRPcmlnaW46IHN0cmluZztcbiAgc2NyaXB0VXJsOiBzdHJpbmc7XG4gIHNlcmlhbGl6ZWRJbnRlcmZhY2U6IERpY3Q7XG59XG5cbmV4cG9ydCBjbGFzcyBDb25uZWN0b3I8U291cmNlVD4ge1xuICBwcml2YXRlIGNvbm5lY3Rpb25TdGF0ZTogQ29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLklETEU7XG4gIHByaXZhdGUgY29ubmVjdGlvblBvbGw6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgcHJpdmF0ZSBjb25uZWN0aW9uUHJvbWlzZTogUHJvbWlzZTxDb25uZWN0UmVzcG9uc2U+O1xuICBwcml2YXRlIHJlc29sdmVDb25uZWN0aW9uITogKHZhbHVlOiBDb25uZWN0UmVzcG9uc2UpID0+IHZvaWQ7XG4gIHByaXZhdGUgcmVqZWN0Q29ubmVjdGlvbiE6IChyZWFzb246IHN0cmluZykgPT4gdm9pZDtcblxuICBwcml2YXRlIGhhbmRzaGFrZU9ic2VydmVyOiBIYW5kc2hha2VPYnNlcnZlcjtcbiAgcHJpdmF0ZSBhY2NlcHRPYnNlcnZlcjogQWNjZXB0T2JzZXJ2ZXI7XG4gIHByaXZhdGUgcmVqZWN0T2JzZXJ2ZXI6IFJlamVjdE9ic2VydmVyO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgbWVzc2VuZ2VyOiBJVW5kaXJlY3RlZE1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXAsIEluY29taW5nRGF0YU1hcCwgU291cmNlVD4sXG4gICAgcHJpdmF0ZSB0YXJnZXQ6IElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyPE91dGdvaW5nRGF0YU1hcCwgU291cmNlVD4sXG4gICAgcHJpdmF0ZSBzb3VyY2U6IFNvdXJjZVRcbiAgKSB7XG4gICAgY2xhc3MgQ29ubmVjdG9yRmFjYWRlIHtcbiAgICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgY29ubmVjdG9yOiBDb25uZWN0b3I8U291cmNlVD4pIHt9XG4gICAgICBwdWJsaWMgaGFuZHNoYWtlKCkge1xuICAgICAgICB0aGlzLmNvbm5lY3Rvci5oYW5kc2hha2UoKTtcbiAgICAgIH1cbiAgICAgIHB1YmxpYyBhY2NlcHQoc291cmNlSWQ6IG51bWJlciwgc2NyaXB0VXJsOiBzdHJpbmcsIHNlcmlhbGl6ZWRJbnRlcmZhY2U6IERpY3QsIHRhcmdldElkOiBudW1iZXIsIHRhcmdldE9yaWdpbjogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuY29ubmVjdG9yLmFjY2VwdChzb3VyY2VJZCwgc2NyaXB0VXJsLCBzZXJpYWxpemVkSW50ZXJmYWNlLCB0YXJnZXRJZCwgdGFyZ2V0T3JpZ2luKTtcbiAgICAgIH1cbiAgICAgIHB1YmxpYyByZWplY3QocmVhc29uOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5jb25uZWN0b3IucmVqZWN0KHJlYXNvbik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgY29ubmVjdG9yRmFjYWRlID0gbmV3IENvbm5lY3RvckZhY2FkZSh0aGlzKTtcblxuICAgIHRoaXMuaGFuZHNoYWtlT2JzZXJ2ZXIgPSBuZXcgSGFuZHNoYWtlT2JzZXJ2ZXIoY29ubmVjdG9yRmFjYWRlKTtcbiAgICB0aGlzLmFjY2VwdE9ic2VydmVyID0gbmV3IEFjY2VwdE9ic2VydmVyKGNvbm5lY3RvckZhY2FkZSk7XG4gICAgdGhpcy5yZWplY3RPYnNlcnZlciA9IG5ldyBSZWplY3RPYnNlcnZlcihjb25uZWN0b3JGYWNhZGUpO1xuICAgIHRoaXMuY29ubmVjdGlvblByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHtcbiAgICAgIHRoaXMucmVzb2x2ZUNvbm5lY3Rpb24gPSByZXM7XG4gICAgICB0aGlzLnJlamVjdENvbm5lY3Rpb24gPSByZWo7XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgY29ubmVjdCh2ZXJzaW9uOiBzdHJpbmcsIG9wdGlvbnM6IFBhcnRpYWw8Q29ubmVjdE9wdGlvbnM+ID0ge30pOiBQcm9taXNlPENvbm5lY3RSZXNwb25zZT4ge1xuICAgIGlmICh0aGlzLmNvbm5lY3Rpb25TdGF0ZSA9PT0gQ29ubmVjdGlvblN0YXRlLklETEUpIHtcbiAgICAgIHRoaXMuY29ubmVjdGlvblN0YXRlID0gQ29ubmVjdGlvblN0YXRlLkNPTk5FQ1RJTkc7XG4gICAgICB0aGlzLm1lc3Nlbmdlci5hZGRPYnNlcnZlcih0aGlzLmhhbmRzaGFrZU9ic2VydmVyKTtcbiAgICAgIHRoaXMubWVzc2VuZ2VyLmFkZE9ic2VydmVyKHRoaXMuYWNjZXB0T2JzZXJ2ZXIpO1xuICAgICAgdGhpcy5tZXNzZW5nZXIuYWRkT2JzZXJ2ZXIodGhpcy5yZWplY3RPYnNlcnZlcik7XG4gICAgICAvLyBUT0RPOiBmaWd1cmUgb3V0IGEgYmV0dGVyIHdheSB0byBlbnN1cmUgY29ubmVjdGlvblxuICAgICAgdGhpcy5jb25uZWN0aW9uUG9sbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgIC8vIHNlbmQgdGhlIG1lc3NhZ2UgdG8gYW55Ym9keSB3aG8ncyBsaXN0ZW5pbmcgd2l0aGluIHRoZSB0YXJnZXQgd2luZG93XG4gICAgICAgIHRoaXMubWVzc2VuZ2VyLnNlbmQobmV3IENvbm5lY3RNZXNzYWdlKHZlcnNpb24sIG9wdGlvbnMpLCBBTllfVEFSR0VULCB0aGlzLnRhcmdldCwgdGhpcy5zb3VyY2UpO1xuICAgICAgfSwgNTAwKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5jb25uZWN0aW9uUHJvbWlzZTtcbiAgfVxuXG4gIHB1YmxpYyBjYW5jZWxDb25uZWN0aW5nKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNvbm5lY3Rpb25TdGF0ZSA8IENvbm5lY3Rpb25TdGF0ZS5DT05ORUNURUQpIHtcbiAgICAgIHRoaXMuc3RvcENvbm5lY3RQb2xsaW5nKCk7XG4gICAgICB0aGlzLnJlamVjdENvbm5lY3Rpb24oJ1VzZXIgbWFudWFsbHkgY2FuY2VsbGVkIGNvbm5lY3Rpb24nKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRzaGFrZSgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jb25uZWN0aW9uU3RhdGUgPCBDb25uZWN0aW9uU3RhdGUuSEFORFNIQUtFKSB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb25TdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5IQU5EU0hBS0U7XG4gICAgICB0aGlzLnN0b3BDb25uZWN0UG9sbGluZygpO1xuXG4gICAgICB0aGlzLm1lc3Nlbmdlci5yZW1vdmVPYnNlcnZlcih0aGlzLmhhbmRzaGFrZU9ic2VydmVyKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFjY2VwdChzb3VyY2VJZDogbnVtYmVyLCBzY3JpcHRVcmw6IHN0cmluZywgc2VyaWFsaXplZEludGVyZmFjZTogRGljdCwgdGFyZ2V0SWQ6IG51bWJlciwgdGFyZ2V0T3JpZ2luOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jb25uZWN0aW9uU3RhdGUgPCBDb25uZWN0aW9uU3RhdGUuQ09OTkVDVEVEKSB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb25TdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5DT05ORUNURUQ7XG5cbiAgICAgIHRoaXMubWVzc2VuZ2VyLnJlbW92ZU9ic2VydmVyKHRoaXMuaGFuZHNoYWtlT2JzZXJ2ZXIpO1xuICAgICAgdGhpcy5tZXNzZW5nZXIucmVtb3ZlT2JzZXJ2ZXIodGhpcy5hY2NlcHRPYnNlcnZlcik7XG4gICAgICB0aGlzLm1lc3Nlbmdlci5yZW1vdmVPYnNlcnZlcih0aGlzLnJlamVjdE9ic2VydmVyKTtcbiAgICAgIHRoaXMuc3RvcENvbm5lY3RQb2xsaW5nKCk7XG5cbiAgICAgIHRoaXMucmVzb2x2ZUNvbm5lY3Rpb24oe1xuICAgICAgICBzb3VyY2VJZCxcbiAgICAgICAgdGFyZ2V0SWQsXG4gICAgICAgIHRhcmdldE9yaWdpbixcbiAgICAgICAgc2NyaXB0VXJsLFxuICAgICAgICBzZXJpYWxpemVkSW50ZXJmYWNlLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByZWplY3QocmVhc29uOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jb25uZWN0aW9uU3RhdGUgPCBDb25uZWN0aW9uU3RhdGUuQ09OTkVDVEVEKSB7XG4gICAgICB0aGlzLmNvbm5lY3Rpb25TdGF0ZSA9IENvbm5lY3Rpb25TdGF0ZS5SRUpFQ1RFRDtcblxuICAgICAgdGhpcy5tZXNzZW5nZXIucmVtb3ZlT2JzZXJ2ZXIodGhpcy5oYW5kc2hha2VPYnNlcnZlcik7XG4gICAgICB0aGlzLm1lc3Nlbmdlci5yZW1vdmVPYnNlcnZlcih0aGlzLmFjY2VwdE9ic2VydmVyKTtcbiAgICAgIHRoaXMubWVzc2VuZ2VyLnJlbW92ZU9ic2VydmVyKHRoaXMucmVqZWN0T2JzZXJ2ZXIpO1xuICAgICAgdGhpcy5zdG9wQ29ubmVjdFBvbGxpbmcoKTtcblxuICAgICAgdGhpcy5yZWplY3RDb25uZWN0aW9uKHJlYXNvbik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdG9wQ29ubmVjdFBvbGxpbmcoKTogdm9pZCB7XG4gICAgY2xlYXJJbnRlcnZhbCh0aGlzLmNvbm5lY3Rpb25Qb2xsKTtcbiAgICB0aGlzLmNvbm5lY3Rpb25Qb2xsID0gdW5kZWZpbmVkO1xuICB9XG5cbn1cbiIsImltcG9ydCB0eXBlIHsgSU1lc3NhZ2UgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUgeyBDb25uZWN0T3B0aW9ucyB9IGZyb20gJ0BzZGsvdHlwZXMnO1xuaW1wb3J0IHR5cGUgeyBDb25uZWN0UGF5bG9hZCwgT3V0Z29pbmdEYXRhTWFwfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuaW1wb3J0IHsgT3V0Z29pbmdNZXNzYWdlVHlwZSB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBDb25uZWN0TWVzc2FnZSBpbXBsZW1lbnRzIElNZXNzYWdlPE91dGdvaW5nTWVzc2FnZVR5cGUuQ09OTkVDVCwgT3V0Z29pbmdEYXRhTWFwPiB7XG4gIHB1YmxpYyByZWFkb25seSB0eXBlID0gT3V0Z29pbmdNZXNzYWdlVHlwZS5DT05ORUNUO1xuICBwdWJsaWMgcmVhZG9ubHkgcGF5bG9hZDogQ29ubmVjdFBheWxvYWQ7XG5cbiAgY29uc3RydWN0b3IoYm9vdHN0cmFwVmVyc2lvbjogc3RyaW5nLCBvcHRpb25zOiBQYXJ0aWFsPENvbm5lY3RPcHRpb25zPiA9IHt9KSB7XG4gICAgdGhpcy5wYXlsb2FkID0ge1xuICAgICAgYm9vdHN0cmFwVmVyc2lvbixcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgYXV0aDogb3B0aW9ucy5hdXRoLFxuICAgICAgICBwcm92aWRlcjogb3B0aW9ucy5wcm92aWRlcixcbiAgICAgIH0sXG4gICAgfTtcbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUgeyBDbGllbnRJbmZvLCBJTWVzc2FnZU9ic2VydmVyIH0gZnJvbSAnQHNkay9tZXNzZW5nZXJzJztcbmltcG9ydCB0eXBlIHsgSW5jb21pbmdEYXRhTWFwLCBIYW5kc2hha2VQYXlsb2FkIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcbmltcG9ydCB7IEluY29taW5nTWVzc2FnZVR5cGUgfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEhhbmRzaGFrZVJlY2VpdmVyIHtcbiAgaGFuZHNoYWtlKCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBIYW5kc2hha2VPYnNlcnZlciBpbXBsZW1lbnRzIElNZXNzYWdlT2JzZXJ2ZXI8SW5jb21pbmdNZXNzYWdlVHlwZS5IQU5EU0hBS0UsIEluY29taW5nRGF0YU1hcD4ge1xuICBwdWJsaWMgcmVhZG9ubHkgbWVzc2FnZVR5cGUgPSBJbmNvbWluZ01lc3NhZ2VUeXBlLkhBTkRTSEFLRTtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWNlaXZlcjogSGFuZHNoYWtlUmVjZWl2ZXIpIHsgfVxuXG4gIHB1YmxpYyBub3RpZnkoX2hhbmRzaGFrZTogSGFuZHNoYWtlUGF5bG9hZCwgX2NsaWVudEluZm86IENsaWVudEluZm8sIF90aW1lc3RhbXA6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMucmVjZWl2ZXIuaGFuZHNoYWtlKCk7XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgQ2xpZW50SW5mbywgSU1lc3NhZ2VPYnNlcnZlciB9IGZyb20gJ0BzZGsvbWVzc2VuZ2Vycyc7XG5pbXBvcnQgdHlwZSB7IEluY29taW5nRGF0YU1hcCwgQWNjZXB0UGF5bG9hZCB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5pbXBvcnQgeyBJbmNvbWluZ01lc3NhZ2VUeXBlIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcblxudHlwZSBEaWN0PFQgPSB1bmtub3duPiA9IFJlY29yZDxzdHJpbmcsIFQgfCB1bmRlZmluZWQ+O1xuXG5leHBvcnQgaW50ZXJmYWNlIEFjY2VwdFJlY2VpdmVyIHtcbiAgYWNjZXB0KHNvdXJjZUlkOiBudW1iZXIsIHNjcmlwdFVybDogc3RyaW5nLCBzZXJpYWxpemVkSW50ZXJmYWNlOiBEaWN0LCB0YXJnZXRJZDogbnVtYmVyLCB0YXJnZXRPcmlnaW46IHN0cmluZyk6IHZvaWQ7XG59XG5cbmV4cG9ydCBjbGFzcyBBY2NlcHRPYnNlcnZlciBpbXBsZW1lbnRzIElNZXNzYWdlT2JzZXJ2ZXI8SW5jb21pbmdNZXNzYWdlVHlwZS5BQ0NFUFQsIEluY29taW5nRGF0YU1hcD4ge1xuICBwdWJsaWMgcmVhZG9ubHkgbWVzc2FnZVR5cGUgPSBJbmNvbWluZ01lc3NhZ2VUeXBlLkFDQ0VQVDtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWNlaXZlcjogQWNjZXB0UmVjZWl2ZXIpIHt9XG5cbiAgcHVibGljIG5vdGlmeShhY2NlcHQ6IEFjY2VwdFBheWxvYWQsIF9jbGllbnRJbmZvOiBDbGllbnRJbmZvLCBfdGltZXN0YW1wOiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCB7IHNvdXJjZUlkLCBzY3JpcHRVcmwsIHRhcmdldElkLCB0YXJnZXRPcmlnaW4gfSA9IGFjY2VwdDtcbiAgICBjb25zdCBzZXJpYWxpemVkSW50ZXJmYWNlID0gYWNjZXB0LmludGVyZmFjZTsgLy8gY2FuJ3QgYmUgZGVzdHJ1Y3R1cmVkIGJlY2F1c2UgYGludGVyZmFjZWAgaXMgYSByZXNlcnZlZCB3b3JkXG5cbiAgICB0aGlzLnJlY2VpdmVyLmFjY2VwdChzb3VyY2VJZCwgc2NyaXB0VXJsLCBzZXJpYWxpemVkSW50ZXJmYWNlLCB0YXJnZXRJZCwgdGFyZ2V0T3JpZ2luKTtcbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUgeyBDbGllbnRJbmZvLCBJTWVzc2FnZU9ic2VydmVyIH0gZnJvbSAnQHNkay9tZXNzZW5nZXJzJztcbmltcG9ydCB0eXBlIHsgSW5jb21pbmdEYXRhTWFwLCBSZWplY3RQYXlsb2FkIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcbmltcG9ydCB7IEluY29taW5nTWVzc2FnZVR5cGUgfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFJlamVjdFJlY2VpdmVyIHtcbiAgcmVqZWN0KHJlYXNvbjogc3RyaW5nKTogdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIFJlamVjdE9ic2VydmVyIGltcGxlbWVudHMgSU1lc3NhZ2VPYnNlcnZlcjxJbmNvbWluZ01lc3NhZ2VUeXBlLlJFSkVDVCwgSW5jb21pbmdEYXRhTWFwPiB7XG4gIHB1YmxpYyByZWFkb25seSBtZXNzYWdlVHlwZSA9IEluY29taW5nTWVzc2FnZVR5cGUuUkVKRUNUO1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlY2VpdmVyOiBSZWplY3RSZWNlaXZlcikge31cblxuICBwdWJsaWMgbm90aWZ5KHJlamVjdDogUmVqZWN0UGF5bG9hZCwgX2NsaWVudEluZm86IENsaWVudEluZm8sIF90aW1lc3RhbXA6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMucmVjZWl2ZXIucmVqZWN0KHJlamVjdC5yZWFzb24pO1xuICB9XG59XG4iLCJpbXBvcnQgdHlwZSB7IEluZGV4S2V5IH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKipcbiAqIEFuIG9iamVjdCB0byB1c2UgaW4gcGxhY2Ugb2YgYSBjYWxsYmFja1xuICogQXZvaWRzIGlzc3VlcyB3aXRoIHVuYm91bmQgZnVuY3Rpb25zXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSU9ic2VydmVyPFQgZXh0ZW5kcyB1bmtub3duW10+IHtcbiAgbm90aWZ5KC4uLmRhdGE6IFQpOiB2b2lkO1xufVxuXG4vKipcbiAqIEluZm9ybWF0aW9uIGFib3V0IGEgY2xpZW50IHNlbmRpbmcgbWVzc2FnZXNcbiAqL1xuZXhwb3J0IHR5cGUgQ2xpZW50SW5mbyA9IHtcbiAgaWQ6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBBbiBvYnNlcnZlciBhc3NvY2lhdGVkIHdpdGggYSBzcGVjaWZpYyB0eXBlIG9mIG1lc3NhZ2VcbiAqIE5vdGlmaWVkIG9mIGluY29taW5nIG1lc3NhZ2VzIG9mIHR5cGUgYEluY29taW5nTWVzc2FnZVR5cGVgXG4gKlxuICogQHBhcmFtIEluY29taW5nTWVzc2FnZVR5cGUgVGhlIG1lc3NhZ2UgdHlwZSB0byBsaXN0ZW4gZm9yXG4gKiBAcGFyYW0gSW5jb21pbmdEYXRhTWFwVCBBIG1hcCBiZXR3ZWVuIEluY29taW5nTWVzc2FnZVR5cGUgYW5kIGRhdGEgcmVjZWl2ZWQgYW5kIHVzZWQgd2l0aGluIGBub3RpZnlgXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSU1lc3NhZ2VPYnNlcnZlcjxcbiAgSW5jb21pbmdNZXNzYWdlVHlwZSBleHRlbmRzIGtleW9mIEluY29taW5nRGF0YU1hcFQsXG4gIEluY29taW5nRGF0YU1hcFQsXG4gIENsaWVudEluZm9UIGV4dGVuZHMgQ2xpZW50SW5mbyA9IENsaWVudEluZm8sXG4+IHtcbiAgLyoqIFRoZSBtZXNzYWdlIHR5cGUgdG8gbGlzdGVuIGZvciAqL1xuICByZWFkb25seSBtZXNzYWdlVHlwZTogSW5jb21pbmdNZXNzYWdlVHlwZTtcbiAgLyoqIEEgY2FsbGJhY2sgY2FsbGVkIHdoZW4gYW4gSU1lc3NhZ2UgcmVjZWl2ZXMgYW4gYEluY29taW5nTWVzc2FnZVR5cGVgIG1lc3NhZ2UgKi9cbiAgbm90aWZ5KHBheWxvYWQ6IEluY29taW5nRGF0YU1hcFRbSW5jb21pbmdNZXNzYWdlVHlwZV0sIGNsaWVudEluZm86IENsaWVudEluZm9ULCBzZW50QXRUaW1lc3RhbXA6IG51bWJlcik6IHZvaWQ7XG59XG5cbi8qKlxuICogQSBmYWN0b3J5IHRvIGNyZWF0ZSBJTWVzc2VuZ2Vyc1xuICpcbiAqIEBwYXJhbSBPdXRnb2luZ0RhdGFNYXBUIFRoZSBvdXRnb2luZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZFxuICogQHBhcmFtIEluY29taW5nRGF0YU1hcFQgVGhlIGluY29taW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSU1lc3NlbmdlckZhY3Rvcnk8T3V0Z29pbmdEYXRhTWFwVCxJbmNvbWluZ0RhdGFNYXBUPiB7XG4gIC8qKlxuICAgKiBDcmVhdGUgYW4gSU1lc3NlbmdlciB0aGF0IGNhbiBzZW5kIGBPdXRnb2luZ0RhdGFNYXBUYCBhbmQgY2FuIHJlY2VpdmUgYEluY29taW5nRGF0YU1hcFRgXG4gICAqL1xuICBjcmVhdGVNZXNzZW5nZXIoKTogSU1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXBULCBJbmNvbWluZ0RhdGFNYXBUPjtcbn1cblxuLyoqXG4gKiBBIGJpLWRpcmVjdGlvbmFsIGNvbW11bmljYXRvciB0aGF0IGNhblxuICogLSByZWNlaXZlIG1lc3NhZ2Ugb2YgdHlwZSBga2V5b2YgSW5jb21pbmdEYXRhTWFwVGAgdmlhIG9ic2VydmVyc1xuICogLSBzZW5kIG1lc3NhZ2VzIG9mIHR5cGUgYGtleW9mIE91dGdvaW5nRGF0YU1hcFRgXG4gKlxuICogQHBhcmFtIE91dGdvaW5nRGF0YU1hcFQgVGhlIG91dGdvaW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkXG4gKiBAcGFyYW0gSW5jb21pbmdEYXRhTWFwVCBUaGUgaW5jb21pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWQgYnkgcmVnaXN0ZXJlZCBvYnNlcnZlcnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJTWVzc2VuZ2VyPFxuICBPdXRnb2luZ0RhdGFNYXBULFxuICBJbmNvbWluZ0RhdGFNYXBULFxuPiB7XG4gIC8qKiB0ZWFyIGRvd24gdGhpcyBtZXNzZW5nZXIgKi9cbiAgaW5pdCgpOiB2b2lkO1xuICAvKiogdGVhciBkb3duIHRoaXMgbWVzc2VuZ2VyICovXG4gIGRpc3Bvc2UoKTogdm9pZDtcbiAgLyoqIFJlZ2lzdGVyIGFuIGBvYnNlcnZlcmAgdG8gbGlzdGVuIGZvciBpbmNvbWluZyBtZXNzYWdlcyAqL1xuICBhZGRPYnNlcnZlcihvYnNlcnZlcjogSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4pOiB2b2lkO1xuICAvKiogUmVtb3ZlIGFuIGBvYnNlcnZlcmAgZnJvbSBsaXN0ZW5pbmcgdG8gaW5jb21pbmcgbWVzc2FnZXMgKi9cbiAgcmVtb3ZlT2JzZXJ2ZXIob2JzZXJ2ZXI6IElNZXNzYWdlT2JzZXJ2ZXI8SW5kZXhLZXk8SW5jb21pbmdEYXRhTWFwVD4sIEluY29taW5nRGF0YU1hcFQ+KTogdm9pZDtcbiAgLyoqIFNlbmQgYSBgbWVzc2FnZWAgdG8gdGhlIHRhcmdldCAqL1xuICBzZW5kKG1lc3NhZ2U6IElNZXNzYWdlPEluZGV4S2V5PE91dGdvaW5nRGF0YU1hcFQ+LCBPdXRnb2luZ0RhdGFNYXBUPik6IHZvaWQ7XG59XG5cbi8qKlxuICogQSBicmlkZ2UgYmV0d2VlbiBhIG1lc3NlbmdlciBhbmQgdGhlIHVuZGVybHlpbmcgbWVzc2VuZ2luZyBtZWNoYW5pc20sIGFsbG93aW5nIHRoZSBtZXNzZW5nZXIgdG8gYmUgbW9yZSBnZW5lcmljXG4gKiBVc2VmdWwgaW4gYWJzdHJhY3RpbmcgYXdheSBzb21ldGhpbmcgbGlrZSB3aW5kb3cucG9zdE1lc3NhZ2UgZnJvbSBhbiBgSU1lc3NlbmdlcmBcbiAqXG4gKiBAcGFyYW0gT3V0Z29pbmdEYXRhTWFwVCBUaGUgb3V0Z29pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWRcbiAqIEBwYXJhbSBJbmNvbWluZ0RhdGFNYXBUIFRoZSBpbmNvbWluZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZCBieSByZWdpc3RlcmVkIG9ic2VydmVyc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIElNZXNzZW5nZXJCcmlkZ2U8XG4gIE91dGdvaW5nRGF0YU1hcFQsXG4gIEluY29taW5nRGF0YU1hcFQsXG4+IHtcbiAgLyoqIFR1cm4gb24gdGhlIGFiaWxpdHkgdG8gcmVjZWl2ZSBtZXNzYWdlcyBmcm9tIGFub3RoZXIgY2xpZW50ICovXG4gIGxpc3RlbihvYnNlcnZlcjogSU9ic2VydmVyPFtJQnJpZGdlTWVzc2FnZTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4sIENsaWVudEluZm9dPik6IHZvaWQ7XG4gIC8qKiBUdXJuIG9mZiB0aGUgYWJpbGl0eSB0byByZWNlaXZlIG1lc3NhZ2VzICovXG4gIHN0b3BMaXN0ZW5pbmcoKTogdm9pZDtcbiAgLyoqIFNlbmQgbWVzc2FnZSB0byB0aGUgYW5vdGhlciBjbGllbnQgKi9cbiAgc2VuZChtZXNzYWdlOiBJQnJpZGdlTWVzc2FnZTxJbmRleEtleTxPdXRnb2luZ0RhdGFNYXBUPiwgT3V0Z29pbmdEYXRhTWFwVD4pOiB2b2lkO1xufVxuXG4vKipcbiAqIEEgYmktZGlyZWN0aW9uYWwgY29tbXVuaWNhdG9yIHRoYXQgY2FuXG4gKiAtIG9wZW5seSByZWNlaXZlIG1lc3NhZ2VzIG9mIHR5cGUgYGtleW9mIEluY29taW5nRGF0YU1hcFRgIHZpYSBvYnNlcnZlcnMgZnJvbSB1bnNwZWNpZmllZCBzb3VyY2VzXG4gKiAtIHNlbmQgbWVzc2FnZXMgb2YgdHlwZSBga2V5b2YgT3V0Z29pbmdEYXRhTWFwVGAgdG8gdGFyZ2V0cyBzcGVjaWZpZWQgd2hlbiBzZW5kaW5nXG4gKlxuICogQHBhcmFtIE91dGdvaW5nRGF0YU1hcFQgVGhlIG91dGdvaW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkXG4gKiBAcGFyYW0gSW5jb21pbmdEYXRhTWFwVCBUaGUgaW5jb21pbmcgbWVzc2FnZSB0eXBlcyBzdXBwb3J0ZWQgYnkgcmVnaXN0ZXJlZCBvYnNlcnZlcnNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJVW5kaXJlY3RlZE1lc3NlbmdlcjxcbiAgT3V0Z29pbmdEYXRhTWFwVCxcbiAgSW5jb21pbmdEYXRhTWFwVCxcbiAgU291cmNlVCxcbj4ge1xuICAvKiogUmVnaXN0ZXIgYW4gYG9ic2VydmVyYCB0byBsaXN0ZW4gZm9yIGluY29taW5nIG1lc3NhZ2VzICovXG4gIGFkZE9ic2VydmVyKG9ic2VydmVyOiBJTWVzc2FnZU9ic2VydmVyPEluZGV4S2V5PEluY29taW5nRGF0YU1hcFQ+LCBJbmNvbWluZ0RhdGFNYXBUPik6IHZvaWQ7XG4gIC8qKiBSZW1vdmUgYW4gYG9ic2VydmVyYCBmcm9tIGxpc3RlbmluZyB0byBpbmNvbWluZyBtZXNzYWdlcyAqL1xuICByZW1vdmVPYnNlcnZlcihvYnNlcnZlcjogSU1lc3NhZ2VPYnNlcnZlcjxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4pOiB2b2lkO1xuICAvKiogU2VuZCBhIGBtZXNzYWdlYCB0byB0aGUgYHRhcmdldGAgKi9cbiAgc2VuZChcbiAgICBtZXNzYWdlOiBJTWVzc2FnZTxJbmRleEtleTxPdXRnb2luZ0RhdGFNYXBUPiwgT3V0Z29pbmdEYXRhTWFwVD4sXG4gICAgdGFyZ2V0SWQ6IG51bWJlciB8IHR5cGVvZiBBTllfVEFSR0VULCB0YXJnZXQ6IElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyPE91dGdvaW5nRGF0YU1hcFQsIFNvdXJjZVQ+LFxuICAgIHNvdXJjZTogU291cmNlVCxcbiAgKTogdm9pZDtcbiAgLyoqIFRlYXIgZG93biB0aGlzIG1lc3NlbmdlciAqL1xuICBkaXNwb3NlKCk6IHZvaWQ7XG59XG5cbi8qKlxuICogQSBzcGVjaWFsIGlkIHRvIHN5bWJvbGl6ZSB0aGUgbWVzc2FnZSBzaG91bGQgZ28gdG8gYWxsIG90aGVyIGBJVW5kaXJlY3RlZExpc3RlbmVyc2AuXG4gKiBGb3IgdXNlIHdpdGggYElVbmRpcmVjdGVkTWVzc2VuZ2VyYCBhbmQgYElVbmRpcmVjdGVkTWVzc2VuZ2VyU2VuZGVyYC5cbiAqL1xuZXhwb3J0IGNvbnN0IEFOWV9UQVJHRVQgPSAtMTtcblxuLyoqXG4gKiBBIGJyaWRnZSBiZXR3ZWVuIGEgbWVzc2VuZ2VyIGFuZCB0aGUgdW5kZXJseWluZyBtZXNzYWdlIHJlY2VpdmluZyBtZWNoYW5pc20sIGFsbG93aW5nIHRoZSBtZXNzZW5nZXIgdG8gYmUgbW9yZSBnZW5lcmljXG4gKiBVc2VmdWwgaW4gYWJzdHJhY3RpbmcgYXdheSBzb21ldGhpbmcgbGlrZSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciBmcm9tIGFuIGBJTWVzc2VuZ2VyYFxuICpcbiAqIEBwYXJhbSBJbmNvbWluZ0RhdGFNYXBUIFRoZSBpbmNvbWluZyBtZXNzYWdlIHR5cGVzIHN1cHBvcnRlZCBieSByZWdpc3RlcmVkIG9ic2VydmVyc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIElVbmRpcmVjdGVkTWVzc2VuZ2VyTGlzdGVuZXI8XG4gIEluY29taW5nRGF0YU1hcFQsXG4+IHtcbiAgLyoqIFR1cm4gb24gdGhlIGFiaWxpdHkgdG8gcmVjZWl2ZSBtZXNzYWdlcyBmcm9tIGFub3RoZXIgY2xpZW50ICovXG4gIGxpc3RlbihvYnNlcnZlcjogSU9ic2VydmVyPFtJQnJpZGdlTWVzc2FnZTxJbmRleEtleTxJbmNvbWluZ0RhdGFNYXBUPiwgSW5jb21pbmdEYXRhTWFwVD4sIENsaWVudEluZm9dPik6IHZvaWQ7XG4gIC8qKiBUdXJuIG9mZiB0aGUgYWJpbGl0eSB0byByZWNlaXZlIG1lc3NhZ2VzICovXG4gIHN0b3BMaXN0ZW5pbmcoKTogdm9pZDtcbn1cblxuLyoqXG4gKiBBIGJyaWRnZSBiZXR3ZWVuIGEgbWVzc2VuZ2VyIGFuZCB0aGUgdW5kZXJseWluZyBtZXNzYWdlIHNlbmRpbmcgbWVjaGFuaXNtLCBhbGxvd2luZyB0aGUgbWVzc2VuZ2VyIHRvIGJlIG1vcmUgZ2VuZXJpY1xuICogVXNlZnVsIGluIGFic3RyYWN0aW5nIGF3YXkgc29tZXRoaW5nIGxpa2Ugd2luZG93LnBvc3RNZXNzYWdlIGZyb20gYW4gYElNZXNzZW5nZXJgXG4gKlxuICogQHBhcmFtIE91dGdvaW5nRGF0YU1hcFQgVGhlIG91dGdvaW5nIG1lc3NhZ2UgdHlwZXMgc3VwcG9ydGVkXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSVVuZGlyZWN0ZWRNZXNzZW5nZXJTZW5kZXI8XG4gIE91dGdvaW5nRGF0YU1hcFQsXG4gIFNvdXJjZVQsXG4+IHtcbiAgLyoqIFNlbmQgbWVzc2FnZSB0byB0aGUgY2xpZW50ICovXG4gIHNlbmQobWVzc2FnZTogSUJyaWRnZU1lc3NhZ2U8SW5kZXhLZXk8T3V0Z29pbmdEYXRhTWFwVD4sIE91dGdvaW5nRGF0YU1hcFQ+LCBzb3VyY2U6IFNvdXJjZVQpOiB2b2lkO1xufVxuXG4vKipcbiAqIFRoZSBiYXNlIGRhdGEgZm9yIGVhY2ggbWVzc2FnZSAoYm90aCBvdXRnb2luZyBhbmQgaW5jb21pbmcpXG4gKlxuICogQHBhcmFtIE1lc3NhZ2VUeXBlIFRoZSB0eXBlIG9mIHRoZSBtZXNzYWdlXG4gKiBAcGFyYW0gUGF5bG9hZE1hcCBUaGUgbWFwIGJldHdlZW4gbWVzc2FnZSB0eXBlcyBhbmQgdGhlaXIgcGF5bG9hZHNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJTWVzc2FnZTxcbiAgTWVzc2FnZVR5cGUgZXh0ZW5kcyBrZXlvZiBQYXlsb2FkTWFwVCxcbiAgUGF5bG9hZE1hcFQsXG4+IHtcbiAgLyoqIFRoZSBzcGVjaWZpYyB0eXBlIG9mIG1lc3NhZ2UgKi9cbiAgdHlwZTogTWVzc2FnZVR5cGU7XG4gIC8qKiBUaGUgZGF0YSB0byBzZW5kICovXG4gIHBheWxvYWQ6IFBheWxvYWRNYXBUW01lc3NhZ2VUeXBlXTtcbn1cblxuLyoqXG4gKiBUaGUgYmFzZSBkYXRhIGZvciBlYWNoIGxvd2VyIGxldmVsIG1lc3NhZ2UgdHlwZXMgYmVpbmcgcmVjZWl2ZWQgYnkgdGhlIGJyaWRnZXNcbiAqXG4gKiBAcGFyYW0gTWVzc2FnZVR5cGUgVGhlIHR5cGUgb2YgdGhlIG1lc3NhZ2VcbiAqIEBwYXJhbSBQYXlsb2FkTWFwIFRoZSBtYXAgYmV0d2VlbiBtZXNzYWdlIHR5cGVzIGFuZCB0aGVpciBwYXlsb2Fkc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIElCcmlkZ2VNZXNzYWdlPFxuICBNZXNzYWdlVHlwZSBleHRlbmRzIGtleW9mIFBheWxvYWRNYXBULFxuICBQYXlsb2FkTWFwVCxcbj4ge1xuICAvKiogVGhlIHNwZWNpZmljIHR5cGUgb2YgbWVzc2FnZSAqL1xuICB0eXBlOiBNZXNzYWdlVHlwZTtcbiAgLyoqIFRoZSBkYXRhIHJlY2VpdmVkICovXG4gIHBheWxvYWQ6IFBheWxvYWRNYXBUW01lc3NhZ2VUeXBlXTtcbiAgLyoqIFRoZSB0aW1lc3RhbXAgb2Ygd2hlbiB0aGUgbWVzc2FnZSB3YXMgc2VudCAqL1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbiAgLyoqIFRoZSBpZCBvZiB0aGUgY2xpZW50IHNlbmRpbmcgdGhlIG1lc3NhZ2UgKi9cbiAgZnJvbUlkOiBudW1iZXI7XG4gIC8qKiBUaGUgaWQgb2YgdGhlIGNsaWVudCB0aGF0IHNob3VsZCByZWNlaXZlIHRoaXMgbWVzc2FnZSAqL1xuICB0b0lkOiBudW1iZXIgfCBudW1iZXJbXTtcbn1cbiIsImltcG9ydCB7IFBvc3RNZXNzYWdlRmFjdG9yeSwgUG9zdE1lc3NhZ2VMaXN0ZW5lciwgUG9zdE1lc3NhZ2VTZW5kZXIsIFVuZGlyZWN0ZWRNZXNzZW5nZXIgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUge1xuICBJU2RrQ29ubmVjdG9yfSBmcm9tICcuL01QX1NESyc7XG5pbXBvcnQge1xuICBNUF9TREssXG59IGZyb20gJy4vTVBfU0RLJztcbmltcG9ydCB0eXBlIHsgQ29ubmVjdFJlc3BvbnNlIH0gZnJvbSAnLi9Db25uZWN0b3InO1xuaW1wb3J0IHsgQ29ubmVjdG9yIH0gZnJvbSAnLi9Db25uZWN0b3InO1xuaW1wb3J0IHR5cGUgeyBJbmNvbWluZ0RhdGFNYXAsIE91dGdvaW5nRGF0YU1hcCB9IGZyb20gJy4vTWVzc2FnZVR5cGVzJztcbmltcG9ydCB0eXBlIHsgTXBTZGssIENvbm5lY3RPcHRpb25zIH0gZnJvbSAnQHNkay90eXBlcyc7XG5cbmV4cG9ydCBjb25zdCB2ZXJzaW9uID0gJzMuMCc7XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29ubmVjdCh0YXJnZXRXaW5kb3c6IEhUTUxJRnJhbWVFbGVtZW50LCBvcHRpb25zOiBQYXJ0aWFsPENvbm5lY3RPcHRpb25zPiA9IHt9KTogUHJvbWlzZTxNcFNkaz4ge1xuICBjb25zdCB0YXJnZXQgPSBnZXRXaW5kb3codGFyZ2V0V2luZG93KTtcbiAgaWYgKCF0YXJnZXQpIHJldHVybiBQcm9taXNlLnJlamVjdCgnaW52YWxpZCB3aW5kb3cnKTtcblxuICAvLyBjcmVhdGUgYSB3YXkgdG8gY3JlYXRlIGNvbW11bmljYXRpb24gY2hhbm5lbHMgKElNZXNzYWdlKSBhbmQgc2V0IHVwIGEgUG9zdE1lc3NhZ2UgdG8gdXNlIGZvciBjb25uZWN0aW5nXG4gIGNvbnN0IHNvdXJjZUlkID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDAwMCk7IC8vIGEgdGVtcCBpZCB0byB1c2Ugd2hpbGUgY29ubmVjdGluZ1xuICBjb25zdCBwb3N0TWVzc2FnZUxpc3RlbmVyID0gbmV3IFBvc3RNZXNzYWdlTGlzdGVuZXI8SW5jb21pbmdEYXRhTWFwPih3aW5kb3cpO1xuICBjb25zdCBwb3N0TWVzYWdlU2VuZGVyID0gbmV3IFBvc3RNZXNzYWdlU2VuZGVyPE91dGdvaW5nRGF0YU1hcD4odGFyZ2V0KTtcbiAgY29uc3QgcG9zdE1lc3NhZ2UgPSBuZXcgVW5kaXJlY3RlZE1lc3NlbmdlcjxPdXRnb2luZ0RhdGFNYXAsIEluY29taW5nRGF0YU1hcCwgV2luZG93Pihzb3VyY2VJZCwgcG9zdE1lc3NhZ2VMaXN0ZW5lcik7XG4gIHBvc3RNZXNzYWdlLmluaXQoKTtcblxuICAvLyBjb25uZWN0XG4gIGNvbnN0IGNvbm5lY3RvciA9IG5ldyBDb25uZWN0b3I8V2luZG93Pihwb3N0TWVzc2FnZSwgcG9zdE1lc2FnZVNlbmRlciwgd2luZG93KTtcbiAgcmV0dXJuIE1QX1NESy5jb25uZWN0KG5ldyBFbWJlZENvbm5lY3Rvcihjb25uZWN0b3IsIHBvc3RNZXNzYWdlLCBvcHRpb25zKSwgbmV3IEVtYmVkTWVzc2VuZ2VyRmFjdG9yeUZldGNoZXIodGFyZ2V0KSwgd2luZG93KTtcbn1cblxuZnVuY3Rpb24gZ2V0V2luZG93KGVsZW1lbnQ6IEhUTUxJRnJhbWVFbGVtZW50KTogV2luZG93IHwgbnVsbCB7XG4gIGlmIChlbGVtZW50LmNvbnRlbnRXaW5kb3cpIHJldHVybiBlbGVtZW50LmNvbnRlbnRXaW5kb3c7XG4gIHJldHVybiBudWxsO1xufVxuXG5jbGFzcyBFbWJlZENvbm5lY3RvciBpbXBsZW1lbnRzIElTZGtDb25uZWN0b3I8Q29ubmVjdFJlc3BvbnNlPiB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgY29ubmVjdG9yOiBDb25uZWN0b3I8V2luZG93PixcbiAgICBwcml2YXRlIHBvc3RNZXNzYWdlOiBVbmRpcmVjdGVkTWVzc2VuZ2VyPE91dGdvaW5nRGF0YU1hcCwgSW5jb21pbmdEYXRhTWFwLCBXaW5kb3c+LFxuICAgIHByaXZhdGUgb3B0aW9uczogUGFydGlhbDxDb25uZWN0T3B0aW9ucz4sXG4gICkge31cbiAgcHVibGljIGNvbm5lY3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29ubmVjdG9yLmNvbm5lY3QodmVyc2lvbiwgdGhpcy5vcHRpb25zKTtcbiAgfVxuXG4gIHB1YmxpYyBjYW5jZWxDb25uZWN0aW5nKCkge1xuICAgIHRoaXMucG9zdE1lc3NhZ2UuZGlzcG9zZSgpO1xuICB9XG59XG5cbmNsYXNzIEVtYmVkTWVzc2VuZ2VyRmFjdG9yeUZldGNoZXIge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHRhcmdldDogV2luZG93KSB7fVxuICBwdWJsaWMgZ2V0RmFjdG9yeShjb25uZWN0UmVzcG9uc2U6IENvbm5lY3RSZXNwb25zZSkge1xuICAgIHJldHVybiBuZXcgUG9zdE1lc3NhZ2VGYWN0b3J5KGNvbm5lY3RSZXNwb25zZS5zb3VyY2VJZCwgd2luZG93LCBjb25uZWN0UmVzcG9uc2UudGFyZ2V0SWQsIHRoaXMudGFyZ2V0LCBjb25uZWN0UmVzcG9uc2UudGFyZ2V0T3JpZ2luKTtcbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUgeyBJTWVzc2FnZSB9IGZyb20gJ0BzZGsvbWVzc2VuZ2Vycyc7XG5pbXBvcnQgdHlwZSB7IEhhbmRzaGFrZVBheWxvYWQsIEluY29taW5nRGF0YU1hcH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcbmltcG9ydCB7IEluY29taW5nTWVzc2FnZVR5cGUgfSBmcm9tICcuLi9NZXNzYWdlVHlwZXMnO1xuXG5leHBvcnQgY2xhc3MgSGFuZHNoYWtlTWVzc2FnZSBpbXBsZW1lbnRzIElNZXNzYWdlPEluY29taW5nTWVzc2FnZVR5cGUuSEFORFNIQUtFLCBJbmNvbWluZ0RhdGFNYXA+IHtcbiAgcHVibGljIHJlYWRvbmx5IHR5cGUgPSBJbmNvbWluZ01lc3NhZ2VUeXBlLkhBTkRTSEFLRTtcbiAgcHVibGljIHJlYWRvbmx5IHBheWxvYWQ6IEhhbmRzaGFrZVBheWxvYWQ7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5wYXlsb2FkID0ge307XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgSU1lc3NhZ2UgfSBmcm9tICdAc2RrL21lc3NlbmdlcnMnO1xuaW1wb3J0IHR5cGUgeyBBY2NlcHRQYXlsb2FkLCBJbmNvbWluZ0RhdGFNYXB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5pbXBvcnQgeyBJbmNvbWluZ01lc3NhZ2VUeXBlIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcblxuZXhwb3J0IGNsYXNzIEFjY2VwdE1lc3NhZ2UgaW1wbGVtZW50cyBJTWVzc2FnZTxJbmNvbWluZ01lc3NhZ2VUeXBlLkFDQ0VQVCwgSW5jb21pbmdEYXRhTWFwPiB7XG4gIHB1YmxpYyByZWFkb25seSB0eXBlID0gSW5jb21pbmdNZXNzYWdlVHlwZS5BQ0NFUFQ7XG4gIHB1YmxpYyByZWFkb25seSBwYXlsb2FkOiBBY2NlcHRQYXlsb2FkO1xuXG4gIC8vIFRPT0QgKHNkayAxLnggc3VwcG9ydCk6IFNESyBib290c3RyYXAgMS54IGV4cGVjdHMgdGhlIGBpbnRlcmZhY2VgIHRvIGJlIGF0IHRoZSByb290IG9mIHRoZSBtZXNzYWdlc1xuICBwdWJsaWMgaW50ZXJmYWNlOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcblxuICBjb25zdHJ1Y3RvcihzY3JpcHRVcmw6IHN0cmluZywgY2xpZW50SW50ZXJmYWNlOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwgc291cmNlSWQ6IG51bWJlciwgdGFyZ2V0SWQ6IG51bWJlciwgdGFyZ2V0T3JpZ2luOiBzdHJpbmcpIHtcbiAgICB0aGlzLnBheWxvYWQgPSB7XG4gICAgICBzY3JpcHRVcmwsXG4gICAgICBpbnRlcmZhY2U6IGNsaWVudEludGVyZmFjZSxcbiAgICAgIHNvdXJjZUlkLFxuICAgICAgdGFyZ2V0SWQsXG4gICAgICB0YXJnZXRPcmlnaW4sXG4gICAgfTtcbiAgICB0aGlzLmludGVyZmFjZSA9IGNsaWVudEludGVyZmFjZTtcbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUgeyBJTWVzc2FnZSB9IGZyb20gJ0BzZGsvbWVzc2VuZ2Vycyc7XG5pbXBvcnQgdHlwZSB7IEluY29taW5nRGF0YU1hcCwgUmVqZWN0UGF5bG9hZCB9IGZyb20gJy4uL01lc3NhZ2VUeXBlcyc7XG5pbXBvcnQgeyBJbmNvbWluZ01lc3NhZ2VUeXBlIH0gZnJvbSAnLi4vTWVzc2FnZVR5cGVzJztcblxuZXhwb3J0IGNsYXNzIFJlamVjdE1lc3NhZ2UgaW1wbGVtZW50cyBJTWVzc2FnZTxJbmNvbWluZ01lc3NhZ2VUeXBlLlJFSkVDVCwgSW5jb21pbmdEYXRhTWFwPiB7XG4gIHB1YmxpYyByZWFkb25seSB0eXBlID0gSW5jb21pbmdNZXNzYWdlVHlwZS5SRUpFQ1Q7XG4gIHB1YmxpYyByZWFkb25seSBwYXlsb2FkOiBSZWplY3RQYXlsb2FkO1xuXG4gIC8vIFRPT0QgKHNkayAxLnggc3VwcG9ydCk6IFNESyBib290c3RyYXAgMS54IGV4cGVjdHMgdGhlIGByZWFzb25gIHRvIGJlIGF0IHRoZSByb290IG9mIHRoZSBtZXNzYWdlc1xuICBwdWJsaWMgcmVhc29uOiBzdHJpbmc7XG4gIGNvbnN0cnVjdG9yKHJlYXNvbjogc3RyaW5nKSB7XG4gICAgdGhpcy5wYXlsb2FkID0ge1xuICAgICAgcmVhc29uLFxuICAgIH07XG4gICAgdGhpcy5yZWFzb24gPSByZWFzb247XG4gIH1cbn1cbiIsImltcG9ydCB0eXBlIHsgQ2xpZW50SW5mbywgSU1lc3NhZ2VPYnNlcnZlciB9IGZyb20gJ0BzZGsvbWVzc2VuZ2Vycyc7XG5pbXBvcnQgdHlwZSB7IE91dGdvaW5nRGF0YU1hcCwgQ29ubmVjdFBheWxvYWQgfSBmcm9tICdAc2RrL2Jvb3RzdHJhcCc7XG5pbXBvcnQgeyBPdXRnb2luZ01lc3NhZ2VUeXBlIH0gZnJvbSAnQHNkay9ib290c3RyYXAnO1xuXG4vKipcbiAqIEFuIG9ic2VydmVyIHRoYXQgcmVjZWl2ZXMgYENvbm5lY3RQYXlsb2FkYCBvYmplY3RzIGluIGl0cyBgb25Db25uZWN0aW9uUmVjZWl2ZWRgIGNhbGxiYWNrXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSUNvbm5lY3RPYnNlcnZlcjxUIGV4dGVuZHMgQ2xpZW50SW5mbz4ge1xuICBvbkNvbm5lY3Rpb25SZWNlaXZlZChjb25uZWN0OiBDb25uZWN0UGF5bG9hZCwgY2xpZW50SW5mbzogVCk6IHZvaWQ7XG59XG5cbi8qKlxuICogQW4gYWRhcHRvciB0byBtYWtlIGFuIGBJQ29ubmVjdE9ic2VydmVyYCBsb29rIGxpa2UgYW4gYElNZXNzYWdlT2JzZXJ2ZXJgICh3aXRoIGEgYG5vdGlmeWAgZnVuY3Rpb24pXG4gKiBDYWxscyB0aGUgaW5wdXQgb2JqZWN0J3MgYG9uQ29ubmVjdGlvblJlY2VpdmVkYCB3aGVuIGEgYENPTk5FQ1RgIG1lc3NhZ2UgaXMgcmVjZWl2ZWQgb24gdGhlIGBJTWVzc2VuZ2VyYCB0aGlzIGlzIHJlZ2lzdGVyZWQgd2l0aC5cbiAqL1xuZXhwb3J0IGNsYXNzIENvbm5lY3RNZXNzYWdlT2JzZXJ2ZXI8VCBleHRlbmRzIENsaWVudEluZm8+IGltcGxlbWVudHMgSU1lc3NhZ2VPYnNlcnZlcjxPdXRnb2luZ01lc3NhZ2VUeXBlLkNPTk5FQ1QsIE91dGdvaW5nRGF0YU1hcCwgVD4ge1xuICBwdWJsaWMgcmVhZG9ubHkgbWVzc2FnZVR5cGUgPSBPdXRnb2luZ01lc3NhZ2VUeXBlLkNPTk5FQ1Q7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVjZWl2ZXI6IElDb25uZWN0T2JzZXJ2ZXI8VD4pIHt9XG5cbiAgcHVibGljIG5vdGlmeShjb25uZWN0OiBDb25uZWN0UGF5bG9hZCwgY2xpZW50SW5mbzogVCk6IHZvaWQge1xuICAgIHRoaXMucmVjZWl2ZXIub25Db25uZWN0aW9uUmVjZWl2ZWQoY29ubmVjdCwgY2xpZW50SW5mbyk7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=